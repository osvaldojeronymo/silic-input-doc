import"./main-ox-hnz0R.js";import"./modulepreload-polyfill-B5Qt9EMX.js";class V{static generateId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}static formatDocument(e){const t=e.replace(/\D/g,"");return t.length===11?t.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"):t.length===14?t.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/,"$1.$2.$3/$4-$5"):e}static formatCEP(e){return e.replace(/\D/g,"").replace(/(\d{5})(\d{3})/,"$1-$2")}static formatMoney(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}static formatCurrency(e){return this.formatMoney(e)}static formatDate(e){return(typeof e=="string"?new Date(e):e).toLocaleDateString("pt-BR")}static applyMask(e,t){e.addEventListener("input",a=>{const i=a.target;let o=i.value.replace(/\D/g,"");switch(t){case"cep":o.length<=8&&(o=o.replace(/(\d{5})(\d)/,"$1-$2"));break;case"phone":o.length<=11&&(o=o.replace(/(\d{2})(\d)/,"($1) $2"),o=o.replace(/(\d{4,5})(\d{4})$/,"$1-$2"));break;case"cpf":o.length<=11&&(o=o.replace(/(\d{3})(\d)/,"$1.$2"),o=o.replace(/(\d{3})(\d)/,"$1.$2"),o=o.replace(/(\d{3})(\d{2})$/,"$1-$2"));break;case"cnpj":o.length<=14&&(o=o.replace(/(\d{2})(\d)/,"$1.$2"),o=o.replace(/(\d{3})(\d)/,"$1.$2"),o=o.replace(/(\d{3})(\d)/,"$1/$2"),o=o.replace(/(\d{4})(\d{2})$/,"$1-$2"));break}i.value=o})}static debounce(e,t){let a;return(...i)=>{clearTimeout(a),a=setTimeout(()=>e(...i),t)}}static escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}static validators={cpf:e=>{const t=e.replace(/\D/g,"");if(t.length!==11||/^(\d)\1+$/.test(t))return!1;let a=0;for(let o=0;o<9;o++)a+=parseInt(t[o])*(10-o);let i=a*10%11;if((i===10||i===11)&&(i=0),i!==parseInt(t[9]))return!1;a=0;for(let o=0;o<10;o++)a+=parseInt(t[o])*(11-o);return i=a*10%11,(i===10||i===11)&&(i=0),i===parseInt(t[10])},cnpj:e=>{const t=e.replace(/\D/g,"");if(t.length!==14||/^(\d)\1+$/.test(t))return!1;let a=0,i=5;for(let n=0;n<12;n++)a+=parseInt(t[n])*i--,i<2&&(i=9);let o=a%11<2?0:11-a%11;if(o!==parseInt(t[12]))return!1;a=0,i=6;for(let n=0;n<13;n++)a+=parseInt(t[n])*i--,i<2&&(i=9);return o=a%11<2?0:11-a%11,o===parseInt(t[13])},email:e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),cep:e=>e.replace(/\D/g,"").length===8}}function G(I){switch(I){case"mudanca-endereco":return"Mudan√ßa de Endere√ßo";case"regularizacao":return"Regulariza√ß√£o";case"ato-formal":return"Ato Formal";default:return z(I)}}function N(I,e){if(e==="nao-se-aplica")return"N√£o se aplica";if(I==="ato-formal")switch(e){case"prorrogacao":return"Prorroga√ß√£o";case"rescisao":return"Rescis√£o";case"alteracao-titularidade":return"Altera√ß√£o de titularidade";case"antecipacao-parcela":return"Antecipa√ß√£o de parcela";case"recebimento-imovel":return"Recebimento de im√≥vel";case"acrescimo-area":return"Acr√©scimo de √°rea";case"supressao-area":return"Supress√£o de √°rea";case"revisao-aluguel":return"Revis√£o de aluguel";case"reajuste-aluguel":return"Reajuste de aluguel";case"apostilamento":return"Apostilamento";case"acao-renovatoria":return"A√ß√£o renovat√≥ria"}return z(e)}function H(I){switch(I){case"nao-se-aplica":return"N√£o se aplica";case"locacao":return"Loca√ß√£o";case"cessao":return"Cess√£o";case"comodato":return"Comodato";default:return z(I)}}function z(I){if(!I)return I;const e=I.replace(/-/g," ");return e.charAt(0).toUpperCase()+e.slice(1)}class J{imoveis=[];imoveisOriginais=[];locadores=[];usandoDadosSAP=!1;currentPage=1;itemsPerPage=10;currentPageImoveis=1;itemsPerPageImoveis=10;currentView="table";constructor(){this.usandoDadosSAP=!1,this.carregarDadosDemo(),this.configurarFiltrosImoveisImediato(),this.configurarItemsPorPagina(),this.atualizarTabelaImoveis(),this.atualizarDashboard()}getEstadoByCidade(e){return{"S√£o Paulo":"SP","Rio de Janeiro":"RJ",Bras√≠lia:"DF",Salvador:"BA",Fortaleza:"CE","Belo Horizonte":"MG",Manaus:"AM",Curitiba:"PR",Recife:"PE",Goi√¢nia:"GO"}[e]||"SP"}gerarCPF(){const e=Array.from({length:9},()=>Math.floor(Math.random()*10));let t=0;for(let o=0;o<9;o++)t+=e[o]*(10-o);const a=t*10%11%10;t=0;for(let o=0;o<9;o++)t+=e[o]*(11-o);t+=a*2;const i=t*10%11%10;return V.formatDocument([...e,a,i].join(""))}gerarCNPJ(){const e=Array.from({length:8},()=>Math.floor(Math.random()*10));e.push(0,0,0,1);let t=0,a=5;for(let n=0;n<12;n++)t+=e[n]*a--,a<2&&(a=9);const i=t%11<2?0:11-t%11;t=0,a=6;for(let n=0;n<12;n++)t+=e[n]*a--,a<2&&(a=9);t+=i*2;const o=t%11<2?0:11-t%11;return V.formatDocument([...e,i,o].join(""))}gerarTelefone(){const e=Math.floor(Math.random()*89)+11,t=Math.floor(Math.random()*9e8)+1e8;return`(${e}) ${t.toString().slice(0,5)}-${t.toString().slice(5)}`}carregarDadosDemo(){this.locadores=[{id:"loc-1",nome:"Jo√£o da Silva",tipo:"fisica",documento:this.gerarCPF(),email:"joao.silva@example.com",telefone:this.gerarTelefone(),endereco:{logradouro:"Rua das Flores",numero:"123",bairro:"Centro",cidade:"S√£o Paulo",estado:"SP",cep:"01000-000"},parteRelacionada:!1,status:"ativo",dataRegistro:new Date().toISOString()},{id:"loc-2",nome:"Im√≥veis XYZ Ltda",tipo:"juridica",documento:this.gerarCNPJ(),email:"contato@imoveisxyz.com.br",telefone:this.gerarTelefone(),endereco:{logradouro:"Av. Paulista",numero:"1500",bairro:"Bela Vista",cidade:"S√£o Paulo",estado:"SP",cep:"01310-000"},parteRelacionada:!0,status:"ativo",dataRegistro:new Date().toISOString()},{id:"loc-3",nome:"Maria Fernanda Alves",tipo:"fisica",documento:this.gerarCPF(),email:"maria.alves@example.com",telefone:this.gerarTelefone(),endereco:{logradouro:"Rua do Lago",numero:"45",bairro:"Jardim",cidade:"Curitiba",estado:"PR",cep:"80000-100"},parteRelacionada:!1,status:"ativo",dataRegistro:new Date().toISOString()},{id:"loc-4",nome:"Construtora Alfa S/A",tipo:"juridica",documento:this.gerarCNPJ(),email:"financeiro@alfa.com.br",telefone:this.gerarTelefone(),endereco:{logradouro:"Av. Brasil",numero:"2000",bairro:"Industrial",cidade:"Porto Alegre",estado:"RS",cep:"90000-200"},parteRelacionada:!1,status:"ativo",dataRegistro:new Date().toISOString()},{id:"loc-5",nome:"Roberto Lima",tipo:"fisica",documento:this.gerarCPF(),email:"roberto.lima@example.com",telefone:this.gerarTelefone(),endereco:{logradouro:"Rua das Ac√°cias",numero:"789",bairro:"Vila Nova",cidade:"Recife",estado:"PE",cep:"50000-300"},parteRelacionada:!0,status:"ativo",dataRegistro:new Date().toISOString()}],this.imoveisOriginais=this.gerarImoveisDemo(100),this.imoveis=[...this.imoveisOriginais]}gerarImoveisDemo(e){const t=["S√£o Paulo","Rio de Janeiro","Bras√≠lia","Salvador","Fortaleza","Belo Horizonte","Manaus","Curitiba","Recife","Goi√¢nia"],a=["Centro","Jardim","Vila Nova","Boa Vista","Industrial","Comercial"],i=["Pr√≥prio","Terceiro"],o=["ativo","prospeccao","mobilizacao","desmobilizacao"],n=[];for(let r=0;r<e;r++){const s=t[r%t.length],c=this.getEstadoByCidade(s),d=a[r%a.length],g=(1e7+r).toString(),b=Math.round(80+Math.random()*920),E=+(1500+Math.random()*8500).toFixed(2),m=String(1+Math.floor(Math.random()*27)).padStart(2,"0"),l=String(1+Math.floor(Math.random()*12)).padStart(2,"0"),v=String(2026+Math.floor(Math.random()*4)),S=`${m}/${l}/${v}`,f={id:`imo-${r+1}`,codigo:g,denominacao:`Contrato ${g} - Unidade ${s}`,tipoContrato:"Contrato de Loca√ß√£o - Im√≥veis",utilizacaoPrincipal:i[r%i.length],fimValidade:S,endereco:`Rua Exemplo ${r+1}`,bairro:d,cidade:s,cep:`${String(1e4+r).padStart(5,"0")}-${String(100+r).padStart(3,"0")}`,estado:c,tipo:"comercial",status:o[r%o.length],area:b,valor:E,descricao:"Im√≥vel gerado para demonstra√ß√£o.",fotos:[],caracteristicas:{quartos:0,banheiros:2,garagem:0},locadorId:this.locadores[r%this.locadores.length].id,dataRegistro:new Date().toISOString(),dataAtualizacao:new Date().toISOString(),tipoEdificioCodigo:"01",parceiroNegocios:this.locadores[r%this.locadores.length].nome,tipoIdFiscal:this.locadores[r%this.locadores.length].tipo==="fisica"?"CPF":"CNPJ",numeroIdFiscal:this.locadores[r%this.locadores.length].documento,denominacaoFuncaoPN:"Proponente Credor",inicioRelacao:"01/01/2025",fimRelacao:`31/12/${v}`,valorAluguelMensal:+(1500+Math.random()*8500).toFixed(2),dataVencimentoAluguel:`${m}/${l}/${v}`,formaPagamentoAluguel:r%3===0?"transferencia":r%3===1?"gru":"boleto",locadoresParticipacao:this.gerarParticipacoesParaImovel(r),beneficiariosImovel:[]},A=f.valorAluguelMensal||f.valor||0;f.valorMensalEstimadoOriginal=A,f.qtdMesesOriginal=48+r%25,f.dataVigenciaInicioOriginal=f.inicioRelacao||"01/01/2025",f.dataVigenciaFimOriginal=f.fimValidade||`31/12/${v}`,f.valorOriginalContrato=(f.valorMensalEstimadoOriginal||0)*(f.qtdMesesOriginal||0),f.historicoPagamentos=this.gerarHistoricoPagamentosDemo(f,r),f.termosAditivos=this.gerarTermosAditivosDemo(f,r),n.push(f)}return n}gerarParticipacoesParaImovel(e){const t=this.locadores,a={banco:"104 - CAIXA",agencia:"1234",dvAgencia:"5",operacaoProduto:"013",conta:"987654",dvConta:"2"},i={banco:"237 - Bradesco",agencia:"0001",dvAgencia:"0",operacaoProduto:"Conta Corrente",conta:"123456",dvConta:"7"},o={banco:"341 - Ita√∫",agencia:"4321",dvAgencia:"1",operacaoProduto:"Conta Corrente",conta:"654321",dvConta:"3"},n=[[{locadorId:t[0%t.length].id,percentual:100,formaPagamento:"transferencia",dadosBancarios:a,representanteLegal:null,recebedorDivergente:null,beneficiarios:[]}],[{locadorId:t[1%t.length].id,percentual:60,formaPagamento:"transferencia",dadosBancarios:o,representanteLegal:null,recebedorDivergente:null,beneficiarios:[]},{locadorId:t[2%t.length].id,percentual:40,formaPagamento:"boleto",representanteLegal:{nome:"Ana Prado",documento:this.gerarCPF(),email:"ana.prado@example.com"},recebedorDivergente:{nome:"Carlos Lima",documento:this.gerarCPF(),dadosBancarios:i},beneficiarios:[{nome:"Assoc. Benef.",documento:this.gerarCNPJ(),percentual:10}]}],[{locadorId:t[3%t.length].id,percentual:50,formaPagamento:"transferencia",dadosBancarios:a,representanteLegal:null,recebedorDivergente:null,beneficiarios:[{nome:"ONG Apoio",documento:this.gerarCNPJ(),percentual:5}]},{locadorId:t[4%t.length].id,percentual:30,formaPagamento:"gru",representanteLegal:null,recebedorDivergente:null,beneficiarios:[]},{locadorId:t[0%t.length].id,percentual:20,formaPagamento:"boleto",representanteLegal:{nome:"Representante Legal",documento:this.gerarCPF(),email:"rep.legal@example.com"},recebedorDivergente:null,beneficiarios:[]}],[{locadorId:t[2%t.length].id,percentual:90,formaPagamento:"boleto",representanteLegal:null,recebedorDivergente:null,beneficiarios:[]},{locadorId:t[1%t.length].id,percentual:10,formaPagamento:"transferencia",dadosBancarios:o,representanteLegal:null,recebedorDivergente:{nome:"Terceiro Recebedor",documento:this.gerarCPF(),dadosBancarios:o},beneficiarios:[]}]];return n[e%n.length]}gerarHistoricoPagamentosDemo(e,t){const a=new Date,i=[],o=(()=>{const r=e.dataVencimentoAluguel;return r&&/^\d{2}\/\d{2}\/\d{4}$/.test(r)?parseInt(r.slice(0,2),10):10})(),n=e.valorAluguelMensal||3e3;for(let r=0;r<6;r++){const s=new Date(a.getFullYear(),a.getMonth()-r,1),c=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`,d=new Date(s.getFullYear(),s.getMonth(),o),g=d.toLocaleDateString("pt-BR"),b=(t+r)%4;if(b===0){const E=new Date(d.getTime());i.push({competencia:c,vencimento:g,valor:n,pagoEm:E.toISOString(),valorPago:n,forma:"transferencia"})}else if(b===1){const E=new Date(d.getTime());E.setDate(E.getDate()+5),i.push({competencia:c,vencimento:g,valor:n,pagoEm:E.toISOString(),valorPago:n,forma:"boleto"})}else if(b===2)i.push({competencia:c,vencimento:g,valor:n,pagoEm:null,valorPago:null,forma:void 0});else{const E=new Date(d.getTime());E.setDate(E.getDate()+15),i.push({competencia:c,vencimento:g,valor:n,pagoEm:E.toISOString(),valorPago:n,forma:"gru"})}}return i}multaPercent=2;jurosMesPercent=1;calcularEncargos(e,t,a){const i=this.parseDate(t),o=a?this.parseDate(a):new Date;if(!i||!o)return{dias:0,multa:0,juros:0,total:e};const n=o.getTime()-i.getTime(),r=Math.floor(n/(1440*60*1e3));if(r<=0)return{dias:0,multa:0,juros:0,total:e};const s=this.multaPercent/100*e,c=this.jurosMesPercent/100/30,d=e*c*r,g=e+s+d;return{dias:r,multa:s,juros:d,total:g}}gerarTermosAditivosDemo(e,t){const a=e.valorMensalEstimadoOriginal||e.valorAluguelMensal||e.valor||5e3,i=this.parseDate(e.dataVigenciaInicioOriginal)||new Date,o=(d,g)=>new Date(d.getFullYear(),d.getMonth()+g,d.getDate()),n=d=>d.toLocaleDateString("pt-BR"),r={numeroTA:`TA-${t+1}-01`,tipoDemanda:"Acr√©scimo",valorMensalEstimado:Math.round(a*1.1),valorGlobalEstimadoAditivo:Math.round(a*1.1*12),valorGlobalAtualizado:Math.round(a*1.1*(e.qtdMesesOriginal||60)),dataInicioEfeitosFinanceiros:n(o(i,18)),dataVigenciaInicio:n(o(i,18)),dataVigenciaFim:n(o(i,30)),qtdMeses:12,percentualAcrescimo:10},s={numeroTA:`TA-${t+1}-02`,tipoDemanda:"Supress√£o",valorMensalEstimado:Math.round(a*.95),valorGlobalEstimadoAditivo:Math.round(a*.95*10),valorGlobalAtualizado:Math.round(a*.95*(e.qtdMesesOriginal||60)),dataInicioEfeitosFinanceiros:n(o(i,30)),dataVigenciaInicio:n(o(i,30)),dataVigenciaFim:n(o(i,40)),qtdMeses:10,percentualSupressao:5},c={numeroTA:`TA-${t+1}-03`,tipoDemanda:"Revis√£o de Pre√ßo",valorMensalEstimado:Math.round(a*1.06),valorGlobalEstimadoAditivo:Math.round(a*1.06*6),valorGlobalAtualizado:Math.round(a*1.06*(e.qtdMesesOriginal||60)),dataInicioEfeitosFinanceiros:n(o(i,40)),dataVigenciaInicio:n(o(i,40)),dataVigenciaFim:n(o(i,46)),qtdMeses:6,percentualRevisaoPreco:6};return[r,s,c]}renderAditivos(e){const t=(m,l)=>this.setElementText(m,l),a=m=>this.formatCurrency(m??0);t("detValMensalEstimadoOriginal",a(e.valorMensalEstimadoOriginal||e.valorAluguelMensal||e.valor)),t("detValorOriginalContrato",a(e.valorOriginalContrato)),t("detDataVigenciaInicioOriginal",e.dataVigenciaInicioOriginal?this.formatDate(e.dataVigenciaInicioOriginal):"-"),t("detDataVigenciaFimOriginal",e.dataVigenciaFimOriginal?this.formatDate(e.dataVigenciaFimOriginal):"-"),t("detQtdMesesOriginal",(e.qtdMesesOriginal??"-").toString());const i=document.querySelector("#tabelaTermosAditivos tbody");if(i){i.innerHTML="";for(const m of e.termosAditivos||[]){const l=document.createElement("tr");l.innerHTML=`
          <td>${m.numeroTA}</td>
          <td>${m.tipoDemanda}</td>
          <td>${a(m.valorMensalEstimado)}</td>
          <td>${a(m.valorGlobalEstimadoAditivo)}</td>
          <td>${a(m.valorGlobalAtualizado)}</td>
          <td>${this.formatDate(m.dataInicioEfeitosFinanceiros)}</td>
          <td>${this.formatDate(m.dataVigenciaInicio)}</td>
          <td>${this.formatDate(m.dataVigenciaFim)}</td>
          <td>${m.qtdMeses??"-"}</td>
          <td>${m.percentualAcrescimo??"-"}</td>
          <td>${m.percentualSupressao??"-"}</td>
          <td>${m.percentualRevisaoPreco??"-"}</td>
        `,i.appendChild(l)}}const o=e.valorOriginalContrato||0,n=(e.termosAditivos||[]).reduce((m,l)=>m+(l.valorGlobalEstimadoAditivo||0),0),r=o+n,s=`${this.formatDate(e.dataVigenciaInicioOriginal)} ‚Äî ${this.formatDate(e.dataVigenciaFimOriginal)}`,c=r*.7,d=(e.historicoPagamentos||[]).reduce((m,l)=>m+(l.valorPago||0),0),g=d*.85,b=r-d,E=c-g;t("resA",a(o)),t("resB",a(n)),t("resC",a(r)),t("resD",s),t("resE",a(c)),t("resF",a(d)),t("resG",a(g)),t("resH",a(b)),t("resI",a(E))}mostrarFormulario(){}adicionarImovel(){}limparFormulario(){}adicionarLocador(){}alterarVisualizacao(e){this.currentView=e}filtrarLocadores(){}limparFiltros(){}atualizarListaLocadores(){}atualizarTabelaImoveis(){const e=document.querySelector(".imoveis-table tbody");if(!e){console.warn("Tabela de im√≥veis n√£o encontrada");return}e.innerHTML="";const t=(this.currentPageImoveis-1)*this.itemsPerPageImoveis,a=t+this.itemsPerPageImoveis;this.imoveis.slice(t,a).forEach(o=>{const n=document.createElement("tr");n.style.cursor="pointer";const r=`badge badge-${o.status}`,s=o.fimValidade||"-";n.innerHTML=`
        <td>${o.codigo}</td>
        <td>${o.denominacao}</td>
        <td>${o.tipoContrato||"Contrato de Loca√ß√£o - Im√≥veis"}</td>
        <td>${o.utilizacaoPrincipal||"-"}</td>
        <td><span class="${r}">${this.formatarStatus(o.status)}</span></td>
        <td>${s}</td>
        <td>
          <button class="btn-table-action" data-id="${o.id}">
            Ver Detalhes
          </button>
        </td>
      `,n.addEventListener("click",d=>{d.target.classList.contains("btn-table-action")||this.abrirModalDetalhes(o.id)});const c=n.querySelector(".btn-table-action");c&&c.addEventListener("click",d=>{d.stopPropagation(),this.abrirModalDetalhes(o.id)}),e.appendChild(n)}),this.atualizarPaginacaoImoveis()}aplicarMascaraCEP(){const e=document.getElementById("cep");e&&V.applyMask(e,"cep")}fecharModalDetalhes(){const e=document.getElementById("modalDetalhes");e&&e.classList.remove("active")}abrirModalDetalhes(e){const t=this.imoveis.find(i=>i.id===e);if(!t){console.error("Im√≥vel n√£o encontrado:",e);return}this.preencherModalDetalhes(t);const a=document.getElementById("modalDetalhes");if(a){a.classList.add("active");const i=a.querySelector(".modal-close");i&&i.addEventListener("click",()=>this.fecharModalDetalhes()),a.addEventListener("click",o=>{o.target===a&&this.fecharModalDetalhes()})}this.configurarTabs(),this.configurarCollapsibles(),this.configurarSectionIndex(),this.inicializarAbaServicos(t)}preencherModalDetalhes(e){const t=document.querySelector(".modal-header h2");t&&(t.textContent="Detalhes"),this.setElementText("detNumeroContrato",e.codigo||"-"),this.setElementOrigin("detNumeroContrato","SAP"),this.setElementText("detDenominacao",e.denominacao||`${e.endereco}, ${e.bairro}`),this.setElementOrigin("detDenominacao","SAP"),this.setElementText("detTipoContrato",e.tipoContrato||"Contrato de Loca√ß√£o - Im√≥veis"),this.setElementOrigin("detTipoContrato","SAP"),this.setElementText("detDataInicio",e.dataRegistro?new Date(e.dataRegistro).toLocaleDateString("pt-BR"):"-"),this.setElementOrigin("detDataInicio","SAP"),this.setElementText("detDataFim",e.fimValidade||e.contratoFimValidade||"-"),this.setElementOrigin("detDataFim","SAP"),this.setElementText("detRescisaoEm",e.contratoRescisaoEm||"-"),this.setElementOrigin("detRescisaoEm","SAP");const a=this.calcularStatusContrato(e);this.setElementText("detContratoStatus",a),this.setElementText("detParceiro",e.parceiroNegocios||"-"),this.setElementOrigin("detParceiro","SAP"),this.setElementText("detEnderecoContrato",e.endereco||"-"),this.setElementOrigin("detEnderecoContrato","SAP"),this.setElementText("detNumeroEndereco",e.numeroPN||"-"),this.setElementOrigin("detNumeroEndereco","SAP"),this.setElementText("detCodPostal",e.cep||"-"),this.setElementOrigin("detCodPostal","SAP"),this.setElementText("detLocal",e.estado||"-"),this.setElementOrigin("detLocal","SAP"),this.setElementText("detRua",e.endereco||"-"),this.setElementOrigin("detRua","SAP"),this.setElementText("detBairro",e.bairro||"-"),this.setElementOrigin("detBairro","SAP"),this.setElementText("detCidade",e.cidade||"-"),this.setElementOrigin("detCidade","SAP"),this.setElementText("detEstado",e.estado||"-"),this.setElementOrigin("detEstado","SAP"),this.setElementText("detCep",e.cep||"-"),this.setElementOrigin("detCep","SAP"),this.setElementText("detTipoEdificio",e.tipoEdificioCodigo||"-"),this.setElementOrigin("detTipoEdificio","SAP"),this.setElementText("detArea",e.area?`${e.area} m¬≤`:"-"),this.setElementOrigin("detArea","SAP"),this.setElementText("detValor",e.valor?`R$ ${e.valor.toFixed(2)}`:"-"),this.setElementOrigin("detValor","SAP");const i=[e.endereco,e.bairro].filter(Boolean).join(", ")+(e.cidade||e.estado?`, ${[e.cidade,e.estado].filter(Boolean).join(" - ")}`:"")+(e.cep?`, ${e.cep}`:"");this.setElementText("detEnderecoCompleto",i||"-"),this.setElementOrigin("detEnderecoCompleto","SAP");const o=this.locadores.find(g=>g.status==="ativo");this.setElementText("detParceiroNegocios",o?o.nome:"-"),this.setElementOrigin("detParceiroNegocios","SAP"),this.setElementText("detTipoIdFiscal",o?o.tipo==="fisica"?"CPF":"CNPJ":"-"),this.setElementOrigin("detTipoIdFiscal","SAP"),this.setElementText("detDenominacaoFuncao","Proponente Credor"),this.setElementOrigin("detDenominacaoFuncao","SAP"),this.setElementText("detInicioRelacao",e.inicioRelacao||"-"),this.setElementOrigin("detInicioRelacao","SAP"),this.setElementText("detFimRelacao",e.fimRelacao||"-"),this.setElementOrigin("detFimRelacao","SAP"),this.setElementText("detNomeLocador",o?o.nome:"-"),this.setElementOrigin("detNomeLocador","SAP"),this.setElementText("detLocadorCep",o?.endereco?.cep||"-"),this.setElementOrigin("detLocadorCep","SAP"),this.setElementText("detLocadorEndereco",o?.endereco?.logradouro||"-"),this.setElementOrigin("detLocadorEndereco","SAP"),this.setElementText("detLocadorNumero",o?.endereco?.numero||"-"),this.setElementOrigin("detLocadorNumero","SAP"),this.setElementText("detLocadorBairro",o?.endereco?.bairro||"-"),this.setElementOrigin("detLocadorBairro","SAP"),this.setElementText("detLocadorLocal",o?.endereco?.cidade||"-"),this.setElementOrigin("detLocadorLocal","SAP"),this.setElementText("detLocadorUf",o?.endereco?.estado||"-"),this.setElementOrigin("detLocadorUf","SAP"),this.setElementText("detLocadorEmail",o?.email||"-"),this.setElementOrigin("detLocadorEmail","SAP"),this.setElementText("detLocadorTelefoneFixo",o?.telefone||"-"),this.setElementOrigin("detLocadorTelefoneFixo","SAP"),this.setElementText("detLocadorTelefoneCelular","-"),this.setElementOrigin("detLocadorTelefoneCelular","SAP"),this.setElementText("detLocadorDoc",o?.documento||"-"),this.setElementOrigin("detLocadorDoc","SAP"),this.setElementText("detValorAluguelMensal",this.formatCurrency(e.valorAluguelMensal)),this.setElementText("detDataVencimentoAluguel",e.dataVencimentoAluguel||"-");const n={transferencia:"Transfer√™ncia",gru:"GRU",boleto:"Boleto"};this.setElementText("detFormaPagamentoAluguel",e.formaPagamentoAluguel?n[e.formaPagamentoAluguel]:"-");const r=document.getElementById("listaParticipacaoLocadores");if(r){r.innerHTML="";const g=e.locadoresParticipacao||[];g.forEach(l=>{const v=this.locadores.find(C=>C.id===l.locadorId),S=document.createElement("div");S.className="card-item";const f=document.createElement("div");f.className="title-row";const A=document.createElement("strong");if(A.textContent=v?.nome||"Locador",f.appendChild(A),v){const C=document.createElement("span");if(C.className=`badge ${v.tipo==="fisica"?"pf":"pj"}`,C.textContent=v.tipo==="fisica"?"PF":"PJ",f.appendChild(C),v.parteRelacionada){const x=document.createElement("span");x.className="badge flag",x.textContent="Parte Relacionada",f.appendChild(x)}}S.appendChild(f);const y=document.createElement("div");y.className="chip-row";const D=document.createElement("span");D.className="badge",D.textContent=`Percentual: ${l.percentual}%`,y.appendChild(D);const $=document.createElement("span");if($.className=`badge pay-${l.formaPagamento}`,$.textContent=`Pagamento: ${n[l.formaPagamento]}`,y.appendChild($),S.appendChild(y),l.formaPagamento==="transferencia"&&l.dadosBancarios){const C=document.createElement("div");C.style.marginTop="6px",C.innerHTML=`<div class="mini-label">Dados banc√°rios</div>
            <div>${l.dadosBancarios.banco||"-"} ¬∑ Ag√™ncia ${l.dadosBancarios.agencia||"-"}-${l.dadosBancarios.dvAgencia||"-"} ¬∑ Opera√ß√£o ${l.dadosBancarios.operacaoProduto||"-"} ¬∑ Conta ${l.dadosBancarios.conta||"-"}-${l.dadosBancarios.dvConta||"-"}</div>`,S.appendChild(C)}if(l.representanteLegal){const C=document.createElement("div");C.style.marginTop="6px",C.innerHTML=`<div class="mini-label">Representante Legal</div>
            <div>${l.representanteLegal.nome} (${l.representanteLegal.documento})</div>`,S.appendChild(C)}if(l.recebedorDivergente){const C=document.createElement("div");C.style.marginTop="6px",C.innerHTML=`<div class="mini-label">Recebedor Divergente</div>
            <div>${l.recebedorDivergente.nome} (${l.recebedorDivergente.documento})</div>`,S.appendChild(C)}if((l.beneficiarios||[]).length>0){const C=document.createElement("div");C.style.marginTop="6px";const x=(l.beneficiarios||[]).map(L=>`${L.nome} (${L.documento})${typeof L.percentual=="number"?` ‚Äì ${L.percentual}%`:""}`).join("<br/>");C.innerHTML=`<div class="mini-label">Benefici√°rios</div><div>${x}</div>`,S.appendChild(C)}r.appendChild(S)});const b=g.reduce((l,v)=>l+(v.percentual||0),0),E=document.createElement("div");E.className="card-item";const m=Math.abs(b-100)<.001;E.innerHTML=`<div class="mini-label">Soma dos percentuais</div><div style="font-weight:600; ${m?"color:#0F5132;":"color:#842029;"}">${b.toFixed(2)}%</div>`,r.appendChild(E)}this.renderHistoricoPagamentos(e),this.renderAditivos(e);const s=document.getElementById("listaBeneficiariosImovel");s&&(s.innerHTML="",(e.beneficiariosImovel||[]).forEach(g=>{const b=document.createElement("div");b.className="card-item";const E=document.createElement("div");E.className="title-row";const m=document.createElement("strong");m.textContent=g.nome,E.appendChild(m),b.appendChild(E);const l=document.createElement("div");if(l.innerHTML=`<div class="mini-label">Documento</div><div>${g.documento}</div>`,b.appendChild(l),typeof g.percentual=="number"){const v=document.createElement("div");v.innerHTML=`<div class="mini-label">Percentual</div><div>${g.percentual}%</div>`,b.appendChild(v)}s.appendChild(b)})),this.setElementText("detNumeroProcesso",e.numeroProcesso||"-"),this.setElementOrigin("detNumeroProcesso","SICLG"),this.setElementText("detNumeroInstrumento",e.numeroInstrumento||"-"),this.setElementOrigin("detNumeroInstrumento","SICLG"),this.setElementText("detNumeroLicitacao",e.numeroLicitacao||"-"),this.setElementOrigin("detNumeroLicitacao","SICLG"),this.setElementText("detTipoInstrumento",e.tipoInstrumento||"-"),this.setElementOrigin("detTipoInstrumento","SICLG"),this.setElementText("detSituacao",e.situacao||"-"),this.setElementOrigin("detSituacao","SICLG"),this.setElementText("detIdPncp",e.idContratoPncp||"-"),this.setElementOrigin("detIdPncp","SICLG"),this.setElementText("detDescricaoObjeto",e.descricaoObjeto||"-"),this.setElementOrigin("detDescricaoObjeto","SICLG"),this.setElementText("detEnquadramentoLegal",e.enquadramentoLegal||"-"),this.setElementOrigin("detEnquadramentoLegal","SICLG"),this.setElementText("detDataAssinatura",this.formatDate(e.dataAssinatura)),this.setElementOrigin("detDataAssinatura","SICLG"),this.setElementText("detVigenciaInicial",this.formatDate(e.vigenciaInicial)),this.setElementOrigin("detVigenciaInicial","SICLG"),this.setElementText("detVigenciaFinal",this.formatDate(e.vigenciaFinal)),this.setElementOrigin("detVigenciaFinal","SICLG"),this.setElementText("detFornecedor",e.fornecedor||"-"),this.setElementOrigin("detFornecedor","SICLG"),this.setElementText("detModalidade",e.modalidade||"-"),this.setElementOrigin("detModalidade","SICLG"),this.setElementText("detGestorFormal",e.gestorFormal||"-"),this.setElementOrigin("detGestorFormal","SICLG"),this.setElementText("detGestaoOperacional",e.gestaoOperacional||"-"),this.setElementOrigin("detGestaoOperacional","SICLG"),this.setElementText("detDataPublicacao",this.formatDate(e.dataPublicacao)),this.setElementOrigin("detDataPublicacao","SICLG"),this.setElementText("detEquipeResponsavel",e.equipeResponsavel||"-"),this.setElementOrigin("detEquipeResponsavel","SICLG"),this.setElementText("detValorOriginal",this.formatCurrency(e.valorOriginal)),this.setElementOrigin("detValorOriginal","SICLG"),this.setElementText("detValorGlobalAtual",this.formatCurrency(e.valorGlobalAtualizado)),this.setElementOrigin("detValorGlobalAtual","SICLG"),this.setElementText("detValorVigenciaAtual",this.formatCurrency(e.valorVigenciaAtual)),this.setElementOrigin("detValorVigenciaAtual","SICLG"),this.setElementText("detValorGlobalAditivado",this.formatCurrency(e.valorGlobalAditivado)),this.setElementOrigin("detValorGlobalAditivado","SICLG");const c=e.prorrogavel;this.setElementText("detProrrogavel",typeof c=="boolean"?c?"Sim":"N√£o":c||"-"),this.setElementOrigin("detProrrogavel","SICLG"),this.setElementText("detTipoGarantida",e.tipoGarantida||"-"),this.setElementOrigin("detTipoGarantida","SICLG"),this.setElementText("detRiscoSocial",e.riscoSocial||"-"),this.setElementOrigin("detRiscoSocial","SICLG"),this.setElementText("detRiscoAmbiental",e.riscoAmbiental||"-"),this.setElementOrigin("detRiscoAmbiental","SICLG"),this.setElementText("detRiscoClimatico",e.riscoClimatico||"-"),this.setElementOrigin("detRiscoClimatico","SICLG");const d=e.codigoCondutaAssinado;this.setElementText("detCodigoCondutaAssinado",typeof d=="boolean"?d?"Sim":"N√£o":d||"-"),this.setElementOrigin("detCodigoCondutaAssinado","SICLG"),this.setElementText("detPartesRelacionadas",e.partesRelacionadas||"-"),this.setElementOrigin("detPartesRelacionadas","SICLG"),this.setElementText("detFornecedorTerceiroRelevante",e.fornecedorTerceiroRelevante||"-"),this.setElementOrigin("detFornecedorTerceiroRelevante","SICLG"),this.setElementText("detFornecedorCondenadoCrimeAmbiental",e.fornecedorCondenadoCrimeAmbiental||"-"),this.setElementOrigin("detFornecedorCondenadoCrimeAmbiental","SICLG"),this.setElementText("detFornecedorSujeitoLicenciamentoAmbiental",e.fornecedorSujeitoLicenciamentoAmbiental||"-"),this.setElementOrigin("detFornecedorSujeitoLicenciamentoAmbiental","SICLG")}inicializarAbaServicos(e){const t=document.getElementById("wizCategoria"),a=document.getElementById("wizAcao"),i=document.getElementById("wizAcaoBlock"),o=document.getElementById("wizModalidade"),n=document.getElementById("wizModalidadeBlock"),r=document.getElementById("wizCenario"),s=document.getElementById("wizCenarioBlock"),c=document.getElementById("servicoDescricao"),d=document.getElementById("dadosPreenchidos"),g=document.getElementById("dadosPendentes"),b=document.getElementById("payloadPreview"),E=document.getElementById("payloadBlock"),m=document.getElementById("detalhesDadosBlock"),l=document.getElementById("toggleDetalhesTecnicos"),v=document.getElementById("btnSolicitarServico");if(!t||!a||!o||!c||!d||!g||!v)return;const S=this.carregarServicosHierarquia();let f="ato-formal",A="",y="",D="completo";const $={...e},O=(u,p)=>{const h={...p};for(const P of u.requisitos)switch(P){case"cep":h.cep="";break;case"endereco":h.endereco="";break;case"cidade":h.cidade="";break;case"estado":h.estado="";break;case"fimValidade":h.fimValidade="";break}return h},C=(u,p)=>{const h=document.createElement("button");h.type="button",h.style.display="flex",h.style.flexDirection="column",h.style.alignItems="flex-start",h.style.gap="4px",h.style.padding="6px 8px",h.style.border="1px solid #d0d7de",h.style.borderRadius="8px",h.style.cursor="pointer",h.style.textAlign="left",h.className="card";const P=document.createElement("strong");P.textContent=u;const T=document.createElement("span");return T.textContent="",T.style.color="#555",T.style.fontSize=".85rem",h.appendChild(P),h},x=u=>{const p=document.createElement("button");return p.type="button",p.textContent=u,p.style.padding="4px 8px",p.style.border="1px solid #d0d7de",p.style.borderRadius="999px",p.style.cursor="pointer",p.className="chip",p},L=()=>{const u=S[f]?.[A]?.[y];if(!u){c.textContent="",d.innerHTML="",g.innerHTML="",b&&(b.textContent=""),v.disabled=!0;return}c.textContent=u.descricao;const p=D==="pendencias"?O(u,$):$,h=this.montarResumoCampos(u,p);this.atualizarResumoDados(d,g,h);const P=this.montarPayloadSolicitacao({id:u.id,nome:u.nome},p);if(b&&(b.textContent=JSON.stringify(P,null,2)),v.disabled=!this.validarRequisitos(u,p),l){const T=h.pendentes.length,R=m&&m.style.display!=="none";l.textContent=R?"Ocultar detalhes t√©cnicos":T>0?`Mostrar detalhes t√©cnicos (${T} pend√™ncias)`:"Mostrar detalhes t√©cnicos"}},w=()=>{t.innerHTML="";const u=Object.keys(S).filter(p=>p==="ato-formal");for(const p of u){const h=G(p),P=C(h);P.onclick=()=>{f=p,A="",y="",w(),a&&(a.innerHTML=""),B(),k(),L(),i&&i.style.setProperty("display","grid","important")},f===p&&P.classList.add("selected"),t.appendChild(P)}},B=u=>{a.innerHTML="";const p=Object.keys(S[f]||{}),h="".toLowerCase(),P=h?p.filter(T=>this.capitalize(T.replace(/-/g," ")).toLowerCase().includes(h)):p;for(const T of P){const R=N(f,T),F=C(R);F.onclick=()=>{A=T,y="",B(),k(),M(),L()},A===T&&F.classList.add("selected"),a.appendChild(F)}},k=()=>{o.innerHTML="";const u=Object.keys(S[f]?.[A]||{});if(u.length===1&&u[0]==="nao-se-aplica"){y="nao-se-aplica",n&&n.style.setProperty("display","none","important");return}n&&n.style.setProperty("display","grid","important");for(const p of u){const h=H(p),P=x(h);P.onclick=()=>{y=p,L()},y===p&&P.classList.add("selected"),o.appendChild(P)}},M=()=>{if(!r||!s)return;r.innerHTML="",s.style.setProperty("display","grid","important");const u=x("Completo"),p=x("Pend√™ncias");u.onclick=()=>{D="completo",M(),L()},p.onclick=()=>{D="pendencias",M(),L()},D==="completo"&&u.classList.add("selected"),D==="pendencias"&&p.classList.add("selected"),r.appendChild(u),r.appendChild(p)};if(v.addEventListener("click",()=>{const u=S[f]?.[A]?.[y];if(!u)return;const p=D==="pendencias"?O(u,$):$,h=this.montarPayloadSolicitacao({id:u.id,nome:u.nome},p);console.log("üì¶ Solicita√ß√£o (prot√≥tipo):",h),this.showToast('Solicita√ß√£o registrada. Seus dados foram encaminhados ao m√≥dulo "Solicitar servi√ßos". Em breve voc√™ poder√° acompanhar o andamento.')}),w(),B(),M(),i&&i.style.setProperty("display","grid","important"),n&&n.style.setProperty("display","none","important"),L(),l&&E&&m){let u=!1;l.textContent="Mostrar detalhes t√©cnicos",E.style.setProperty("display","none","important"),m.style.setProperty("display","none","important"),l.onclick=()=>{u=!u,E.style.setProperty("display",u?"block":"none","important"),m.style.setProperty("display",u?"grid":"none","important"),l.textContent=u?"Ocultar detalhes t√©cnicos":"Mostrar detalhes t√©cnicos"}}}carregarServicosHierarquia(){const e=(t,a,i,o,n)=>({id:`${t}-${a}-${i}`,nome:`${this.capitalize(t.replace(/-/g," "))} - ${this.capitalize(a.replace(/-/g," "))} - ${this.capitalize(i)}`,descricao:o,requisitos:n});return{"mudanca-endereco":{"nao-se-aplica":{"nao-se-aplica":e("mudanca-endereco","nao-se-aplica","nao-se-aplica","Mudan√ßa de endere√ßo do im√≥vel/contrato.",["cep","endereco","cidade","estado"])}},regularizacao:{"nao-se-aplica":{"nao-se-aplica":e("regularizacao","nao-se-aplica","nao-se-aplica","Regulariza√ß√£o contratual.",["fimValidade"])}},"ato-formal":{prorrogacao:{"nao-se-aplica":e("ato-formal","prorrogacao","nao-se-aplica","Prorroga√ß√£o de contrato.",["fimValidade"])},rescisao:{"nao-se-aplica":e("ato-formal","rescisao","nao-se-aplica","Rescis√£o contratual.",["fimValidade"])},"alteracao-titularidade":{"nao-se-aplica":e("ato-formal","alteracao-titularidade","nao-se-aplica","Altera√ß√£o de titularidade.",["fimValidade"])},"antecipacao-parcela":{"nao-se-aplica":e("ato-formal","antecipacao-parcela","nao-se-aplica","Antecipa√ß√£o de parcela.",["fimValidade"])},"recebimento-imovel":{"nao-se-aplica":e("ato-formal","recebimento-imovel","nao-se-aplica","Recebimento de im√≥vel.",["cep","endereco","cidade","estado"])},"acrescimo-area":{"nao-se-aplica":e("ato-formal","acrescimo-area","nao-se-aplica","Acr√©scimo de √°rea contratada.",["fimValidade"])},"supressao-area":{"nao-se-aplica":e("ato-formal","supressao-area","nao-se-aplica","Supress√£o de √°rea contratada.",["fimValidade"])},"revisao-aluguel":{"nao-se-aplica":e("ato-formal","revisao-aluguel","nao-se-aplica","Revis√£o de aluguel.",["fimValidade"])},"reajuste-aluguel":{"nao-se-aplica":e("ato-formal","reajuste-aluguel","nao-se-aplica","Reajuste de aluguel.",["fimValidade"])},apostilamento:{"nao-se-aplica":e("ato-formal","apostilamento","nao-se-aplica","Apostilamento contratual.",["fimValidade"])},"acao-renovatoria":{"nao-se-aplica":e("ato-formal","acao-renovatoria","nao-se-aplica","A√ß√£o renovat√≥ria.",["fimValidade"])}}}}popularServicosSelect(e,t){e.innerHTML="";for(const a of t){const i=document.createElement("option");i.value=a.id,i.textContent=a.nome,e.appendChild(i)}}filtrarServicos(e,t,a){const i=a.toLowerCase(),o=t.filter(n=>n.nome.toLowerCase().includes(i));this.popularServicosSelect(e,o.length?o:t)}validarRequisitos(e,t){const a=i=>{switch(i){case"cep":return!!t.cep;case"endereco":return!!t.endereco;case"cidade":return!!t.cidade;case"estado":return!!t.estado;case"fimValidade":return!!t.fimValidade;default:return!0}};return e.requisitos.every(a)}montarResumoCampos(e,t){const a=[{key:"codigo",label:"Contrato",value:t.codigo},{key:"denominacao",label:"Denomina√ß√£o",value:t.denominacao},{key:"parceiroNegocios",label:"Parceiro",value:t.parceiroNegocios},{key:"cep",label:"CEP",value:t.cep},{key:"endereco",label:"Endere√ßo",value:t.endereco},{key:"bairro",label:"Bairro",value:t.bairro},{key:"cidade",label:"Cidade",value:t.cidade},{key:"estado",label:"UF",value:t.estado},{key:"fimValidade",label:"Fim da validade",value:t.fimValidade}],i=[],o=[];for(const r of a)r.value?i.push({label:r.label,value:r.value}):o.push({label:r.label});const n={cep:"CEP",endereco:"Endere√ßo",cidade:"Cidade",estado:"UF",fimValidade:"Fim da validade"};for(const r of e.requisitos)t[r]||o.push({label:n[r]||r});return{preenchidos:i,pendentes:o}}atualizarResumoDados(e,t,a){e.innerHTML="",t.innerHTML="";const i=document.getElementById("dadosPendentesCol"),o=document.getElementById("dadosPreenchidosCol");for(const n of a.preenchidos){const r=document.createElement("li");r.textContent=`${n.label}: ${n.value}`,r.style.color="#2e7d32",e.appendChild(r)}for(const n of a.pendentes){const r=document.createElement("li");r.textContent=`${n.label}: ‚Äî`,r.style.color="#b26a00",t.appendChild(r)}i&&(i.style.display=a.pendentes.length?"block":"none"),o&&(o.style.display=a.preenchidos.length?"block":"none")}montarPayloadSolicitacao(e,t){return{servico:{id:e.id,nome:e.nome},imovel:{id:t.id,codigo:t.codigo,endereco:t.endereco,cep:t.cep,cidade:t.cidade,estado:t.estado,fimValidade:t.fimValidade},origem:this.usandoDadosSAP?"SAP":"Demo",criadoEm:new Date().toISOString()}}capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}setElementText(e,t){const a=document.getElementById(e);a&&(a.textContent=t)}setElementOrigin(e,t){const a=document.getElementById(e);a&&(t?a.setAttribute("data-origin",t):a.removeAttribute("data-origin"))}formatDate(e){if(!e)return"-";if(/^\d{2}\/\d{2}\/\d{4}$/.test(e))return e;const t=new Date(e);return isNaN(t.getTime())?e||"-":t.toLocaleDateString("pt-BR")}formatCurrency(e){if(e==null||e==="")return"-";const t=typeof e=="string"?parseFloat(e.replace(/[^0-9.,-]/g,"").replace(",",".")):e;if(isNaN(t))return String(e);try{return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t)}catch{return`R$ ${t.toFixed(2)}`}}calcularStatusContrato(e){const t=new Date,a=this.parseDate(e.contratoInicio||e.dataRegistro),i=this.parseDate(e.contratoFimValidade||e.fimValidade),o=this.parseDate(e.contratoRescisaoEm);return o&&o<=t?"Rescindido":i&&i<t?"Vencido":a&&a>t?"Aguardando in√≠cio":a&&(!i||i>=t)?"Vigente":"Indefinido"}parseDate(e){if(!e)return null;if(/^\d{2}\/\d{2}\/\d{4}$/.test(e)){const[a,i,o]=e.split("/").map(Number);return new Date(o,i-1,a)}const t=new Date(e);return isNaN(t.getTime())?null:t}renderHistoricoPagamentos(e){const t=document.getElementById("tabelaHistoricoPagamentos"),a=document.getElementById("resumoEncargosAtraso");if(!t)return;const i=t.querySelector("tbody");i.innerHTML="";let o=0,n=0;(e.historicoPagamentos||[]).forEach(s=>{const c=this.calcularEncargos(s.valor,s.vencimento,s.pagoEm);o+=c.multa,n+=c.juros;const d=document.createElement("tr"),g=(()=>{if(s.pagoEm){const m=this.parseDate(s.vencimento);return this.parseDate(s.pagoEm)>m?"Pago com atraso":"Pago em dia"}const E=this.parseDate(s.vencimento);return new Date>E?"Em atraso":"Em aberto"})(),b=s.pagoEm?s.valorPago??c.total:c.total;d.innerHTML=`
        <td>${s.competencia}</td>
        <td>${s.vencimento}</td>
        <td>${this.formatCurrency(s.valor)}</td>
        <td>${g}</td>
        <td>${s.pagoEm?this.formatDate(s.pagoEm):"-"}</td>
        <td>${c.multa>0?this.formatCurrency(c.multa):"-"}</td>
        <td>${c.juros>0?this.formatCurrency(c.juros):"-"}</td>
        <td>${this.formatCurrency(b)}</td>
      `,i.appendChild(d)}),a&&(a.textContent=`Multas acumuladas: ${this.formatCurrency(o)} ¬∑ Juros acumulados: ${this.formatCurrency(n)}`)}configurarCollapsibles(){const e=Array.from(document.querySelectorAll(".info-section.collapsible"));for(const t of e){const a=t.querySelector(".collapse-toggle");if(!a)continue;const i=a.getAttribute("aria-expanded")==="true";t.classList.toggle("collapsed",!i),a.textContent=i?"Recolher":"Expandir",a.addEventListener("click",()=>{const o=a.getAttribute("aria-expanded")==="true";a.setAttribute("aria-expanded",(!o).toString()),a.textContent=o?"Expandir":"Recolher",t.classList.toggle("collapsed",o)})}}configurarSectionIndex(){const e=Array.from(document.querySelectorAll(".section-index"));if(e.length)for(const t of e){const a=Array.from(t.querySelectorAll("a"));for(const i of a)i.addEventListener("click",o=>{o.preventDefault();const n=i.getAttribute("href")||"",r=n.startsWith("#")?n.slice(1):n,s=document.getElementById(r);if(s){if(s.classList.contains("collapsible")&&s.classList.contains("collapsed")){const c=s.querySelector(".collapse-toggle");c&&(c.setAttribute("aria-expanded","true"),c.textContent="Recolher",s.classList.remove("collapsed"))}try{s.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}catch{const c=document.querySelector(".modal");if(c){const d=s.getBoundingClientRect().top-c.getBoundingClientRect().top+c.scrollTop-60;c.scrollTo({top:d,behavior:"smooth"})}}}})}}setInputValue(e,t){const a=document.getElementById(e);a&&(a.value=t||"")}addEventListenerSafe(e,t,a){const i=document.getElementById(e);i&&i.addEventListener(t,a)}showToast(e){const t=document.getElementById("toastContainer");if(!t){alert(e);return}const a=document.createElement("div");a.textContent=e,a.style.background="#2e7d32",a.style.color="#fff",a.style.padding="10px 14px",a.style.borderRadius="6px",a.style.boxShadow="0 2px 8px rgba(0,0,0,.15)",a.style.fontSize=".95rem",a.style.maxWidth="360px",t.appendChild(a),setTimeout(()=>{a.style.transition="opacity .3s",a.style.opacity="0",setTimeout(()=>a.remove(),300)},2500)}validarData(e,t=!1){if(!e)return t;const a=e.match(/^([0-3]\d)\/(0\d|1[0-2])\/(\d{4})$/);if(!a)return!1;const i=parseInt(a[1],10),o=parseInt(a[2],10),n=parseInt(a[3],10),r=new Date(n,o-1,i);return r.getFullYear()===n&&r.getMonth()===o-1&&r.getDate()===i}mostrarErro(e,t,a){const i=document.getElementById(e);i&&(i.style.display=t?"block":"none",a&&(i.textContent=a))}formatarStatus(e){return{ativo:"Ativo",prospeccao:"Prospec√ß√£o",mobilizacao:"Mobiliza√ß√£o",desmobilizacao:"Desmobiliza√ß√£o",disponivel:"Dispon√≠vel",ocupado:"Ocupado",manutencao:"Manuten√ß√£o",vendido:"Vendido"}[e]||e}configurarTabs(){const e=document.querySelectorAll(".tab-btn"),t=document.querySelectorAll(".tab-content");e.forEach((a,i)=>{a.addEventListener("click",()=>{e.forEach(o=>o.classList.remove("active")),t.forEach(o=>o.classList.remove("active")),a.classList.add("active"),t[i]&&t[i].classList.add("active")})})}atualizarPaginacaoImoveis(){const e=(this.currentPageImoveis-1)*this.itemsPerPageImoveis+1,t=Math.min(this.currentPageImoveis*this.itemsPerPageImoveis,this.imoveis.length),a=this.imoveis.length;this.setElementText("paginationStart",e.toString()),this.setElementText("paginationEnd",t.toString()),this.setElementText("paginationTotal",a.toString()),this.gerarBotoesPaginacao()}gerarBotoesPaginacao(){const e=document.getElementById("paginationControls");if(!e)return;e.innerHTML="";const t=Math.ceil(this.imoveis.length/this.itemsPerPageImoveis);if(t<=1)return;const a=document.createElement("button");a.innerHTML="‚Üê Anterior",a.disabled=this.currentPageImoveis===1,a.addEventListener("click",()=>{this.currentPageImoveis>1&&(this.currentPageImoveis--,this.atualizarTabelaImoveis())}),e.appendChild(a);const i=5;let o=Math.max(1,this.currentPageImoveis-Math.floor(i/2)),n=Math.min(t,o+i-1);if(n-o<i-1&&(o=Math.max(1,n-i+1)),o>1){const s=document.createElement("button");if(s.textContent="1",s.addEventListener("click",()=>{this.currentPageImoveis=1,this.atualizarTabelaImoveis()}),e.appendChild(s),o>2){const c=document.createElement("button");c.textContent="...",c.disabled=!0,e.appendChild(c)}}for(let s=o;s<=n;s++){const c=document.createElement("button");c.textContent=s.toString(),c.classList.toggle("active",s===this.currentPageImoveis);const d=s;c.addEventListener("click",()=>{this.currentPageImoveis=d,this.atualizarTabelaImoveis()}),e.appendChild(c)}if(n<t){if(n<t-1){const c=document.createElement("button");c.textContent="...",c.disabled=!0,e.appendChild(c)}const s=document.createElement("button");s.textContent=t.toString(),s.addEventListener("click",()=>{this.currentPageImoveis=t,this.atualizarTabelaImoveis()}),e.appendChild(s)}const r=document.createElement("button");r.innerHTML="Pr√≥ximo ‚Üí",r.disabled=this.currentPageImoveis===t,r.addEventListener("click",()=>{this.currentPageImoveis<t&&(this.currentPageImoveis++,this.atualizarTabelaImoveis())}),e.appendChild(r)}configurarItemsPorPagina(){const e=document.getElementById("imoveisPorPaginaSelect");e&&e.addEventListener("change",()=>{const t=parseInt(e.value,10);!isNaN(t)&&t>0&&(this.itemsPerPageImoveis=t,this.currentPageImoveis=1,this.atualizarTabelaImoveis())})}configurarFiltrosImoveisImediato(){this.addEventListenerSafe("pesquisarImoveis","click",()=>{this.aplicarFiltrosImoveis()}),this.addEventListenerSafe("limparFiltrosImoveis","click",()=>{this.limparFiltrosImoveis()}),this.addEventListenerSafe("filtroContrato","keypress",e=>{e.key==="Enter"&&this.aplicarFiltrosImoveis()}),this.addEventListenerSafe("filtroDenominacao","keypress",e=>{e.key==="Enter"&&this.aplicarFiltrosImoveis()})}aplicarFiltrosImoveis(){console.log("üîç Aplicando filtros de im√≥veis...");const e=document.getElementById("filtroContrato")?.value.toLowerCase()||"",t=document.getElementById("filtroUtilizacao")?.value||"",a=document.getElementById("filtroStatus")?.value||"",i=document.getElementById("filtroDenominacao")?.value.toLowerCase()||"",o=document.getElementById("filtroDataInicio")?.value||"",n=document.getElementById("filtroDataFim")?.value||"";this.imoveis=this.imoveisOriginais.filter(r=>{if(e&&!r.codigo.toLowerCase().includes(e)||t&&r.utilizacaoPrincipal!==t)return!1;if(a){const s={Ativo:"ativo","Em Prospec√ß√£o":"prospeccao","Em Mobiliza√ß√£o":"mobilizacao","Em Desmobiliza√ß√£o":"desmobilizacao",Desativado:"desativado"};if(r.status!==s[a])return!1}if(i&&!r.denominacao.toLowerCase().includes(i))return!1;if(o||n){if(r.fimValidade){const[s,c,d]=r.fimValidade.split("/"),g=new Date(parseInt(d),parseInt(c)-1,parseInt(s));if(o){const b=new Date(o);if(g<b)return!1}if(n){const b=new Date(n);if(g>b)return!1}}else if(o||n)return!1}return!0}),this.currentPageImoveis=1,this.atualizarTabelaImoveis(),this.atualizarDashboard(),console.log(`‚úÖ Filtros aplicados: ${this.imoveis.length} im√≥veis encontrados`)}limparFiltrosImoveis(){const e=document.getElementById("filtroContrato"),t=document.getElementById("filtroUtilizacao"),a=document.getElementById("filtroStatus"),i=document.getElementById("filtroDenominacao"),o=document.getElementById("filtroDataInicio"),n=document.getElementById("filtroDataFim");e&&(e.value=""),t&&(t.value=""),a&&(a.value=""),i&&(i.value=""),o&&(o.value=""),n&&(n.value=""),this.imoveis=[...this.imoveisOriginais],this.currentPageImoveis=1,this.atualizarTabelaImoveis(),this.atualizarDashboard(),console.log("üßπ Filtros limpos")}atualizarDashboard(){const e=this.calcularEstatisticas();this.setElementText("totalImoveis",e.totalImoveis.toString()),this.setElementText("imoveisAtivos",e.imoveisAtivos.toString()),this.setElementText("imoveisProspeccao",e.imoveisProspeccao.toString()),this.setElementText("imoveisMobilizacao",e.imoveisMobilizacao.toString()),this.setElementText("imoveisDesmobilizacao",e.imoveisDesmobilizacao.toString()),this.atualizarCoberturaCenarios()}calcularEstatisticas(){return{totalImoveis:this.imoveis.length,imoveisAtivos:this.imoveis.filter(e=>e.status==="ativo").length,imoveisProspeccao:this.imoveis.filter(e=>e.status==="prospeccao").length,imoveisMobilizacao:this.imoveis.filter(e=>e.status==="mobilizacao").length,imoveisDesmobilizacao:this.imoveis.filter(e=>e.status==="desmobilizacao").length,totalLocadores:this.locadores.length}}atualizarCoberturaCenarios(){const e={A:0,B:0,C:0,D:0},t=["A","B","C","D"];this.imoveis.forEach(i=>{const o=this.extrairIndiceImovel(i.id);if(o!==null){const n=t[o%t.length];e[n]=(e[n]||0)+1}});const a=document.getElementById("cenariosCoverage");a&&(a.innerHTML="",t.forEach(i=>{const o=document.createElement("span");o.className="chip",o.textContent=`${i}: ${e[i]}`,a.appendChild(o)})),console.log(`üìä Cobertura de cen√°rios A‚ÄìD: A=${e.A}, B=${e.B}, C=${e.C}, D=${e.D}`)}extrairIndiceImovel(e){const t=e.match(/^imo-(\d+)$/);if(!t)return null;const a=parseInt(t[1],10);return Number.isNaN(a)?null:a-1}}function U(){const I="https://osvaldojeronymo.github.io/silic-portal-imoveis/",e=document.referrer,t=window.location.search.includes("from=portal");(e.includes("silic-portal")||t)&&window.history.length>1?window.history.back():window.location.href=I}export{J as SistemaSILIC,U as voltarAoPortal};
