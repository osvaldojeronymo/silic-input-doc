import"./main-2Un1fqfc.js";class E{static generateId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}static formatDocument(e){const o=e.replace(/\D/g,"");return o.length===11?o.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"):o.length===14?o.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/,"$1.$2.$3/$4-$5"):e}static formatCEP(e){return e.replace(/\D/g,"").replace(/(\d{5})(\d{3})/,"$1-$2")}static formatMoney(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}static formatCurrency(e){return this.formatMoney(e)}static formatDate(e){return(typeof e=="string"?new Date(e):e).toLocaleDateString("pt-BR")}static applyMask(e,o){e.addEventListener("input",a=>{const t=a.target;let i=t.value.replace(/\D/g,"");switch(o){case"cep":i.length<=8&&(i=i.replace(/(\d{5})(\d)/,"$1-$2"));break;case"phone":i.length<=11&&(i=i.replace(/(\d{2})(\d)/,"($1) $2"),i=i.replace(/(\d{4,5})(\d{4})$/,"$1-$2"));break;case"cpf":i.length<=11&&(i=i.replace(/(\d{3})(\d)/,"$1.$2"),i=i.replace(/(\d{3})(\d)/,"$1.$2"),i=i.replace(/(\d{3})(\d{2})$/,"$1-$2"));break;case"cnpj":i.length<=14&&(i=i.replace(/(\d{2})(\d)/,"$1.$2"),i=i.replace(/(\d{3})(\d)/,"$1.$2"),i=i.replace(/(\d{3})(\d)/,"$1/$2"),i=i.replace(/(\d{4})(\d{2})$/,"$1-$2"));break}t.value=i})}static debounce(e,o){let a;return(...t)=>{clearTimeout(a),a=setTimeout(()=>e(...t),o)}}static escapeHtml(e){const o=document.createElement("div");return o.textContent=e,o.innerHTML}static validators={cpf:e=>{const o=e.replace(/\D/g,"");if(o.length!==11||/^(\d)\1+$/.test(o))return!1;let a=0;for(let i=0;i<9;i++)a+=parseInt(o[i])*(10-i);let t=a*10%11;if((t===10||t===11)&&(t=0),t!==parseInt(o[9]))return!1;a=0;for(let i=0;i<10;i++)a+=parseInt(o[i])*(11-i);return t=a*10%11,(t===10||t===11)&&(t=0),t===parseInt(o[10])},cnpj:e=>{const o=e.replace(/\D/g,"");if(o.length!==14||/^(\d)\1+$/.test(o))return!1;let a=0,t=5;for(let s=0;s<12;s++)a+=parseInt(o[s])*t--,t<2&&(t=9);let i=a%11<2?0:11-a%11;if(i!==parseInt(o[12]))return!1;a=0,t=6;for(let s=0;s<13;s++)a+=parseInt(o[s])*t--,t<2&&(t=9);return i=a%11<2?0:11-a%11,i===parseInt(o[13])},email:e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),cep:e=>e.replace(/\D/g,"").length===8}}class M{static DATA_PATH="/silic-input-doc/dados-sap.json";static obterCaminho(){return this.DATA_PATH}static converterData(e){if(!e)return"";try{const o=e.split("/");return o.length===3?`${o[2]}-${o[1]}-${o[0]}`:e}catch{return e}}static mapearDadosSAP(e){console.log("üîÑ Mapeando dados do SAP para estrutura da aplica√ß√£o...");const o=e.locadores.map(t=>({id:t.id,nome:t.nome,tipo:t.tipo,documento:t.numeroIdFiscal,email:t.email||void 0,telefone:t.telefone||void 0,endereco:{logradouro:t.endereco.rua,numero:t.endereco.numero.toString(),bairro:t.endereco.bairro,cidade:t.endereco.cidade,estado:t.endereco.regiao,cep:t.endereco.cep},status:t.status,dataRegistro:new Date().toISOString()})),a=e.imoveis.map(t=>{const i=t.edificio.local,s=t.edificio.regiao;let c="comercial";const n=t.edificio.tipoEdificio.nome.toLowerCase();n.includes("terreno")?c="terreno":n.includes("galp√£o")?c="industrial":n.includes("casa")&&(c="residencial");let r="ativo";const l=t.edificio.status.toLowerCase();return l.includes("prospec√ß√£o")?r="prospeccao":l.includes("mobiliza√ß√£o")&&!l.includes("des")?r="mobilizacao":l.includes("desmobiliza√ß√£o")?r="desmobilizacao":l.includes("ativo")&&(r="ativo"),{id:t.id,codigo:t.contrato.numero.toString(),denominacao:t.contrato.denominacao,tipoContrato:t.contrato.tipoContrato,utilizacaoPrincipal:t.edificio.utilizacaoPrincipal,fimValidade:t.contrato.fimValidade,endereco:t.edificio.rua,bairro:t.edificio.bairro,cidade:i,estado:s,cep:t.edificio.cep,tipo:c,status:r,descricao:t.contrato.denominacao,caracteristicas:{tipoContrato:t.contrato.tipoContrato,utilizacaoPrincipal:t.edificio.utilizacaoPrincipal,inicioContrato:t.contrato.inicioContrato,fimValidade:t.contrato.fimValidade,inscricaoIPTU:t.edificio.inscricaoIPTU,numeroITR:t.edificio.numeroITR,tipoEdificio:t.edificio.tipoEdificio.nome,funcao:t.edificio.funcao.nome,estadoConservacao:t.edificio.estadoConservacao},locadorId:t.locadorId,dataRegistro:new Date().toISOString()}});return console.log(`‚úÖ Mapeamento conclu√≠do: ${a.length} im√≥veis, ${o.length} locadores`),{imoveis:a,locadores:o,metadados:{dataImportacao:e.metadados.dataGeracao,fonte:e.metadados.fonte,totalImoveis:e.metadados.totalImoveis,totalLocadores:e.metadados.totalLocadores}}}static async carregarDados(){try{const e=this.obterCaminho();console.log("üîÑ Carregando dados do SAP..."),console.log(`   üìÅ Caminho: ${e}`);const o=await fetch(e);if(!o.ok)return console.warn("‚ö†Ô∏è Arquivo de dados SAP n√£o encontrado. Usando dados demo."),console.warn(`   Status: ${o.status} ${o.statusText}`),null;const a=await o.json(),t=this.mapearDadosSAP(a);return console.log("‚úÖ Dados do SAP carregados com sucesso!"),console.log(`   üìä ${t.metadados.totalImoveis} im√≥veis`),console.log(`   üë• ${t.metadados.totalLocadores} locadores`),console.log(`   üìÖ Gera√ß√£o: ${new Date(t.metadados.dataImportacao).toLocaleString("pt-BR")}`),console.log(`   üè∑Ô∏è Fonte: ${t.metadados.fonte}`),t}catch(e){return console.error("‚ùå Erro ao carregar dados do SAP:",e),console.error("   Detalhes:",e),null}}static async temDadosDisponiveis(){try{return(await fetch(this.DATA_PATH,{method:"HEAD"})).ok}catch{return!1}}static obterEstatisticas(e){const o={totalImoveis:e.imoveis.length,porTipo:{},porStatus:{},totalLocadores:e.locadores.length,porTipoLocador:{}};return e.imoveis.forEach(a=>{o.porTipo[a.tipo]=(o.porTipo[a.tipo]||0)+1,o.porStatus[a.status]=(o.porStatus[a.status]||0)+1}),e.locadores.forEach(a=>{o.porTipoLocador[a.tipo]=(o.porTipoLocador[a.tipo]||0)+1}),o}static formatarInfo(e){const o=this.obterEstatisticas(e);let a=`üìä Dados do SAP (${e.metadados.fonte})
`;return a+=`üìÖ Importado em: ${new Date(e.metadados.dataImportacao).toLocaleString("pt-BR")}

`,a+=`üè¢ IM√ìVEIS (${o.totalImoveis} total):
`,Object.entries(o.porTipo).forEach(([t,i])=>{a+=`   ‚Ä¢ ${t}: ${i}
`}),a+=`
üìà STATUS:
`,Object.entries(o.porStatus).forEach(([t,i])=>{a+=`   ‚Ä¢ ${t}: ${i}
`}),a+=`
üë• LOCADORES (${o.totalLocadores} total):
`,Object.entries(o.porTipoLocador).forEach(([t,i])=>{a+=`   ‚Ä¢ ${t==="fisica"?"Pessoa F√≠sica":"Pessoa Jur√≠dica"}: ${i}
`}),a}}class F{imoveis=[];imoveisOriginais=[];locadores=[];currentPage=1;itemsPerPage=10;currentPageImoveis=1;itemsPerPageImoveis=10;currentView="table";usandoDadosSAP=!1;contratoEdits=new Map;imovelEdits=new Map;locadorEdits=new Map;constructor(){this.inicializar()}inicializar(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{this.setupEventListeners(),this.carregarDados()}):setTimeout(()=>{this.setupEventListeners(),this.carregarDados()},100)}setupEventListeners(){this.addEventListenerSafe("viewTable","click",()=>this.alterarVisualizacao("table")),this.addEventListenerSafe("viewCards","click",()=>this.alterarVisualizacao("cards")),this.addEventListenerSafe("buscaLocador","input",()=>this.filtrarLocadores()),this.addEventListenerSafe("filtroTipo","change",()=>this.filtrarLocadores()),this.addEventListenerSafe("filtroStatus","change",()=>this.filtrarLocadores()),this.addEventListenerSafe("limparFiltros","click",()=>this.limparFiltros()),this.addEventListenerSafe("itensPorPaginaSelect","change",e=>{const o=e.target;this.itemsPerPage=parseInt(o.value),this.currentPage=1,this.atualizarListaLocadores()}),this.addEventListenerSafe("imoveisPorPaginaSelect","change",e=>{const o=e.target;this.itemsPerPageImoveis=parseInt(o.value),this.currentPageImoveis=1,this.atualizarTabelaImoveis()}),this.aplicarMascaraCEP(),document.addEventListener("keydown",e=>{e.key==="Escape"&&this.fecharModalDetalhes()}),this.configurarFiltrosImoveisImediato()}addEventListenerSafe(e,o,a){const t=document.getElementById(e);t&&t.addEventListener(o,a)}async carregarDados(){console.log("üîÑ Iniciando carregamento de dados...");const e=await M.carregarDados();e&&e.imoveis.length>0?(this.imoveis=e.imoveis,this.imoveisOriginais=[...e.imoveis],this.locadores=e.locadores,this.usandoDadosSAP=!0,console.log("‚úÖ Dados do SAP carregados!"),console.log(M.formatarInfo(e)),this.mostrarNotificacao("‚úÖ Dados do SAP carregados com sucesso!","success")):(console.log("üìã Carregando dados de demonstra√ß√£o..."),this.carregarDadosDemo(),this.usandoDadosSAP=!1,this.mostrarNotificacao("üìã Usando dados de demonstra√ß√£o","info")),this.atualizarDashboard(),this.atualizarTabelaImoveis(),this.atualizarListaLocadores(),this.configurarFiltrosImoveisImediato(),this.atualizarIndicadorFonteDados()}atualizarIndicadorFonteDados(){const e=document.querySelector(".title-section");if(!e)return;const o=e.querySelector(".data-source-indicator");o&&o.remove();const a=document.createElement("div");a.className="data-source-indicator",a.style.cssText=`
      margin-top: 0.5rem;
      padding: 0.25rem 0.75rem;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 600;
      display: inline-block;
      ${this.usandoDadosSAP?"background: #e8f5e9; color: #2e7d32;":"background: #fff3e0; color: #f57c00;"}
    `,a.textContent=this.usandoDadosSAP?"üóÇÔ∏è Dados do SAP":"üìã Dados Demo";const t=e.querySelector(".subtitle");t&&t.after(a)}mostrarNotificacao(e,o){const t={success:{bg:"#e8f5e9",text:"#2e7d32",border:"#4caf50"},info:{bg:"#e3f2fd",text:"#1565c0",border:"#2196f3"},warning:{bg:"#fff3e0",text:"#e65100",border:"#ff9800"},error:{bg:"#ffebee",text:"#c62828",border:"#f44336"}}[o],i=document.createElement("div");i.style.cssText=`
      position: fixed;
      top: 20px;
      right: 20px;
      background: ${t.bg};
      color: ${t.text};
      border-left: 4px solid ${t.border};
      padding: 1rem 1.5rem;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      z-index: 10000;
      max-width: 400px;
      animation: slideIn 0.3s ease-out;
      font-weight: 500;
    `,i.textContent=e,document.body.appendChild(i),setTimeout(()=>{i.style.animation="slideOut 0.3s ease-out",setTimeout(()=>i.remove(),300)},5e3)}carregarDadosDemo(){console.log("Iniciando carregamento de dados demo...");try{if(console.log("Gerando im√≥veis..."),this.imoveis=this.gerarImoveisDemo(100),this.imoveisOriginais=[...this.imoveis],console.log(`${this.imoveis.length} im√≥veis gerados`),!this.imoveis||this.imoveis.length===0)throw new Error("Falha na gera√ß√£o de im√≥veis");console.log("Gerando locadores...");try{this.locadores=this.gerarLocadoresDemo(),console.log(`${this.locadores?this.locadores.length:"null"} locadores gerados`)}catch(e){console.error("Erro na gera√ß√£o de locadores:",e),this.locadores=this.gerarLocadoresBasicos()}console.log("Atualizando dashboard..."),this.atualizarDashboard(),console.log("Atualizando tabela..."),this.atualizarTabelaImoveis(),console.log("Configurando filtros..."),this.configurarFiltrosImoveisImediato(),console.log(`Sistema carregado com sucesso! ${this.imoveis.length} im√≥veis, ${this.locadores.length} locadores`)}catch(e){console.error("Erro no carregamento de dados:",e)}}gerarImoveisDemo(e){const o=["S√£o Paulo","Rio de Janeiro","Bras√≠lia","Salvador","Fortaleza","Belo Horizonte","Manaus","Curitiba","Recife","Goi√¢nia"],a=["Centro","Vila Madalena","Copacabana","Ipanema","Leblon","Savassi","Funcion√°rios","Boa Viagem","Aldeota","Meireles"],t=["residencial","comercial","terreno","industrial"],i=["ativo","prospeccao","mobilizacao","desmobilizacao"],s=[];for(let c=1;c<=e;c++){const n=o[Math.floor(Math.random()*o.length)],r=a[Math.floor(Math.random()*a.length)],l=t[Math.floor(Math.random()*t.length)],m=i[Math.floor(Math.random()*i.length)],u=2025+Math.floor(Math.random()*6),g=Math.floor(Math.random()*12)+1,v=`${(Math.floor(Math.random()*28)+1).toString().padStart(2,"0")}/${g.toString().padStart(2,"0")}/${u}`,I={id:E.generateId(),codigo:`IM${String(c).padStart(4,"0")}`,denominacao:`CT - AG ${n.toUpperCase()}, ${this.getEstadoByCidade(n)}`,tipoContrato:"Contrato de Loca√ß√£o - Im√≥veis",utilizacaoPrincipal:"Pr√≥prio",fimValidade:v,endereco:`Rua ${String.fromCharCode(65+Math.floor(Math.random()*26))}${String.fromCharCode(65+Math.floor(Math.random()*26))}, ${Math.floor(Math.random()*9999)+1}`,bairro:r,cidade:n,cep:`${Math.floor(Math.random()*1e5).toString().padStart(5,"0")}-${Math.floor(Math.random()*1e3).toString().padStart(3,"0")}`,estado:this.getEstadoByCidade(n),tipo:l,status:m,area:Math.floor(Math.random()*500)+50,valor:Math.floor(Math.random()*5e5)+1e5,dataRegistro:new Date().toISOString(),caracteristicas:l==="residencial"?{quartos:Math.floor(Math.random()*4)+1,banheiros:Math.floor(Math.random()*3)+1,garagem:Math.floor(Math.random()*3)}:void 0};s.push(I)}return s}gerarLocadoresDemo(){const e=["Jo√£o Silva","Maria Santos","Pedro Costa","Ana Oliveira","Carlos Ferreira","Lucia Almeida","Roberto Lima","Fernanda Rodrigues"],o=["Construtora ABC Ltda","Imobili√°ria XYZ S.A.","Incorporadora DEF","Administradora GHI","Investimentos JKL"],a=[];for(let t=0;t<e.length;t++){const i={id:E.generateId(),nome:e[t],tipo:"fisica",documento:this.gerarCPF(),email:`${e[t].toLowerCase().replace(" ",".")}@email.com`,telefone:this.gerarTelefone(),status:Math.random()>.1?"ativo":"inativo",dataRegistro:new Date().toISOString()};a.push(i)}for(let t=0;t<o.length;t++){const i={id:E.generateId(),nome:o[t],tipo:"juridica",documento:this.gerarCNPJ(),email:`contato@${o[t].toLowerCase().replace(/\s+/g,"").slice(0,10)}.com.br`,telefone:this.gerarTelefone(),status:Math.random()>.1?"ativo":"inativo",dataRegistro:new Date().toISOString()};a.push(i)}return a}gerarLocadoresBasicos(){return[{id:E.generateId(),nome:"Jo√£o Silva",tipo:"fisica",documento:"123.456.789-01",status:"ativo",dataRegistro:new Date().toISOString()},{id:E.generateId(),nome:"Construtora ABC Ltda",tipo:"juridica",documento:"12.345.678/0001-01",status:"ativo",dataRegistro:new Date().toISOString()}]}getEstadoByCidade(e){return{"S√£o Paulo":"SP","Rio de Janeiro":"RJ",Bras√≠lia:"DF",Salvador:"BA",Fortaleza:"CE","Belo Horizonte":"MG",Manaus:"AM",Curitiba:"PR",Recife:"PE",Goi√¢nia:"GO"}[e]||"SP"}gerarCPF(){const e=Array.from({length:9},()=>Math.floor(Math.random()*10));let o=0;for(let i=0;i<9;i++)o+=e[i]*(10-i);const a=o*10%11%10;o=0;for(let i=0;i<9;i++)o+=e[i]*(11-i);o+=a*2;const t=o*10%11%10;return E.formatDocument([...e,a,t].join(""))}gerarCNPJ(){const e=Array.from({length:8},()=>Math.floor(Math.random()*10));e.push(0,0,0,1);let o=0,a=5;for(let s=0;s<12;s++)o+=e[s]*a--,a<2&&(a=9);const t=o%11<2?0:11-o%11;o=0,a=6;for(let s=0;s<12;s++)o+=e[s]*a--,a<2&&(a=9);o+=t*2;const i=o%11<2?0:11-o%11;return E.formatDocument([...e,t,i].join(""))}gerarTelefone(){const e=Math.floor(Math.random()*89)+11,o=Math.floor(Math.random()*9e8)+1e8;return`(${e}) ${o.toString().slice(0,5)}-${o.toString().slice(5)}`}mostrarFormulario(){}adicionarImovel(){}limparFormulario(){}adicionarLocador(){}alterarVisualizacao(e){this.currentView=e}filtrarLocadores(){}limparFiltros(){}atualizarListaLocadores(){}atualizarTabelaImoveis(){const e=document.querySelector(".imoveis-table tbody");if(!e){console.warn("Tabela de im√≥veis n√£o encontrada");return}e.innerHTML="";const o=(this.currentPageImoveis-1)*this.itemsPerPageImoveis,a=o+this.itemsPerPageImoveis;this.imoveis.slice(o,a).forEach(i=>{const s=document.createElement("tr");s.style.cursor="pointer";const c=`badge badge-${i.status}`,n=i.fimValidade||"-";s.innerHTML=`
        <td>${i.codigo}</td>
        <td>${i.denominacao}</td>
        <td>${i.tipoContrato||"Contrato de Loca√ß√£o - Im√≥veis"}</td>
        <td>${i.utilizacaoPrincipal||"-"}</td>
        <td><span class="${c}">${this.formatarStatus(i.status)}</span></td>
        <td>${n}</td>
        <td>
          <button class="btn-table-action" data-id="${i.id}">
            Ver Detalhes
          </button>
        </td>
      `,s.addEventListener("click",l=>{l.target.classList.contains("btn-table-action")||this.abrirModalDetalhes(i.id)});const r=s.querySelector(".btn-table-action");r&&r.addEventListener("click",l=>{l.stopPropagation(),this.abrirModalDetalhes(i.id)}),e.appendChild(s)}),this.atualizarPaginacaoImoveis()}aplicarMascaraCEP(){const e=document.getElementById("cep");e&&E.applyMask(e,"cep")}fecharModalDetalhes(){const e=document.getElementById("modalDetalhes");e&&e.classList.remove("active")}abrirModalDetalhes(e){const o=this.imoveis.find(c=>c.id===e);if(!o){console.error("Im√≥vel n√£o encontrado:",e);return}this.preencherModalDetalhes(o);const a=document.getElementById("modalDetalhes");if(a){a.classList.add("active");const c=a.querySelector(".modal-close");c&&c.addEventListener("click",()=>this.fecharModalDetalhes()),a.addEventListener("click",n=>{n.target===a&&this.fecharModalDetalhes()})}this.configurarTabs(),this.configurarCamposContrato(),this.configurarCamposImovel();const t=document.getElementById("btnSalvarImovel");t&&t.addEventListener("click",()=>this.salvarImovel(e)),this.configurarCamposLocador();const i=document.getElementById("btnSalvarLocador");i&&i.addEventListener("click",()=>this.salvarLocador(e));const s=document.getElementById("btnSalvarContrato");s&&s.addEventListener("click",()=>this.salvarContrato(e))}preencherModalDetalhes(e){const o=document.querySelector(".modal-header h2");o&&(o.textContent="Detalhes do Im√≥vel"),this.setInputValue("contratoNumero",""),this.setInputValue("contratoDenominacao",e.denominacao||`${e.endereco}, ${e.bairro}`),this.setInputValue("contratoTipoEdificio",""),this.setInputValue("contratoCriadoPor",""),this.setInputValue("contratoInicio",e.dataRegistro?new Date(e.dataRegistro).toLocaleDateString("pt-BR"):""),this.setInputValue("contratoFimValidade",e.fimValidade||""),this.setInputValue("contratoRescisao","");const a=this.imovelEdits.get(e.id);this.setInputValue("imovelCep",a?.cep??e.cep??""),this.setInputValue("imovelEndereco",a?.endereco??e.endereco??""),this.setInputValue("imovelNumero",a?.numero??""),this.setInputValue("imovelBairro",a?.bairro??e.bairro??""),this.setInputValue("imovelLocal",a?.local??e.cidade??""),this.setInputValue("imovelUf",a?.uf??e.estado??"");const t=this.locadorEdits.get(e.id),i=this.locadores.find(s=>s.id===e.id);this.setInputValue("locadorParceiro",t?.parceiro??""),this.setInputValue("locadorTipoIdFiscal",t?.tipoIdFiscal??(i?i.tipo==="fisica"?"CPF":"CNPJ":"")),this.setInputValue("locadorDenominacaoFuncao",t?.denominacaoFuncao??"Proponente Credor"),this.setInputValue("locadorInicioRelacao",t?.inicioRelacao??""),this.setInputValue("locadorFimRelacao",t?.fimRelacao??""),this.setInputValue("locadorNome",t?.nome??(i?.nome||"")),this.setInputValue("locadorCep",t?.cep??""),this.setInputValue("locadorEndereco",t?.endereco??""),this.setInputValue("locadorNumero",t?.numero??""),this.setInputValue("locadorBairro",t?.bairro??""),this.setInputValue("locadorLocal",t?.local??""),this.setInputValue("locadorUf",t?.uf??""),this.setInputValue("locadorEmail",t?.email??(i?.email||"")),this.setInputValue("locadorTelefoneFixo",t?.telefoneFixo??(i?.telefone||"")),this.setInputValue("locadorTelefoneCelular",t?.telefoneCelular??"")}capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}setElementText(e,o){const a=document.getElementById(e);a&&(a.textContent=o)}setInputValue(e,o){const a=document.getElementById(e);a&&(a.value=o||"")}configurarCamposContrato(){const e=document.getElementById("contratoNumero"),o=document.getElementById("contratoTipoEdificio"),a=document.getElementById("contratoCriadoPor"),t=document.getElementById("contratoInicio"),i=document.getElementById("contratoFimValidade"),s=document.getElementById("contratoRescisao");e&&e.addEventListener("input",()=>{e.value=e.value.replace(/\D/g,"").slice(0,8)}),o&&o.addEventListener("input",()=>{o.value=o.value.replace(/\D/g,"").slice(0,2)}),a&&a.addEventListener("input",()=>{const n=a.value.toUpperCase().replace(/[^A-Z0-9]/g,""),r=n.replace(/[^A-Z]/g,"").slice(0,1),l=n.replace(/[^0-9]/g,"").slice(0,6);a.value=`${r}${l}`});const c=n=>{n.addEventListener("input",()=>{let r=n.value.replace(/\D/g,"").slice(0,8);r.length>=5?n.value=`${r.slice(0,2)}/${r.slice(2,4)}/${r.slice(4,8)}`:r.length>=3?n.value=`${r.slice(0,2)}/${r.slice(2,4)}`:n.value=r})};if(t&&c(t),i&&c(i),s&&c(s),s&&(s.disabled=!0),i&&s){const n=()=>{s.disabled=i.value.trim().length===0,s.disabled&&(s.value="")};i.addEventListener("input",n),n()}}configurarCamposImovel(){const e=document.getElementById("imovelCep"),o=document.getElementById("imovelNumero"),a=document.getElementById("imovelUf");e&&e.addEventListener("input",()=>{let t=e.value.replace(/\D/g,"").slice(0,8);t.length>5?e.value=`${t.slice(0,5)}-${t.slice(5)}`:e.value=t}),o&&o.addEventListener("input",()=>{o.value=o.value.replace(/\D/g,"").slice(0,6)}),a&&a.addEventListener("input",()=>{a.value=a.value.toUpperCase().replace(/[^A-Z]/g,"").slice(0,2)})}configurarCamposLocador(){const e=document.getElementById("locadorCep"),o=document.getElementById("locadorNumero"),a=document.getElementById("locadorUf"),t=document.getElementById("locadorTelefoneFixo"),i=document.getElementById("locadorTelefoneCelular"),s=document.getElementById("locadorInicioRelacao"),c=document.getElementById("locadorFimRelacao");e&&e.addEventListener("input",()=>{let r=e.value.replace(/\D/g,"").slice(0,8);r.length>5?e.value=`${r.slice(0,5)}-${r.slice(5)}`:e.value=r}),o&&o.addEventListener("input",()=>{o.value=o.value.replace(/\D/g,"").slice(0,6)}),a&&a.addEventListener("input",()=>{a.value=a.value.toUpperCase().replace(/[^A-Z]/g,"").slice(0,2)}),t&&t.addEventListener("input",()=>{let r=t.value.replace(/\D/g,"").slice(0,10);r.length>=7?t.value=`(${r.slice(0,2)}) ${r.slice(2,6)}-${r.slice(6,10)}`:r.length>=3?t.value=`(${r.slice(0,2)}) ${r.slice(2,6)}`:t.value=r}),i&&i.addEventListener("input",()=>{let r=i.value.replace(/\D/g,"").slice(0,11);r.length>=7?i.value=`(${r.slice(0,2)}) ${r.slice(2,7)}-${r.slice(7,11)}`:r.length>=3?i.value=`(${r.slice(0,2)}) ${r.slice(2,7)}`:i.value=r});const n=r=>{r.addEventListener("input",()=>{let l=r.value.replace(/\D/g,"").slice(0,8);l.length>=5?r.value=`${l.slice(0,2)}/${l.slice(2,4)}/${l.slice(4,8)}`:l.length>=3?r.value=`${l.slice(0,2)}/${l.slice(2,4)}`:r.value=l})};s&&n(s),c&&n(c)}salvarLocador(e){const o=document.getElementById("locadorParceiro")?.value||"",a=document.getElementById("locadorTipoIdFiscal")?.value||"",t=document.getElementById("locadorDenominacaoFuncao")?.value||"",i=document.getElementById("locadorInicioRelacao")?.value||"",s=document.getElementById("locadorFimRelacao")?.value||"",c=document.getElementById("locadorNome")?.value||"",n=document.getElementById("locadorCep")?.value||"",r=document.getElementById("locadorEndereco")?.value||"",l=document.getElementById("locadorNumero")?.value||"",m=document.getElementById("locadorBairro")?.value||"",u=document.getElementById("locadorLocal")?.value||"",g=document.getElementById("locadorUf")?.value||"",p=document.getElementById("locadorEmail")?.value||"",v=document.getElementById("locadorTelefoneFixo")?.value||"",I=document.getElementById("locadorTelefoneCelular")?.value||"",h=document.getElementById("statusSalvarLocador"),d=B=>B.trim().length>0,f=/^\d{5}-\d{3}$/.test(n),y=/^\d+$/.test(l)||l.trim().length===0,C=/^[A-Z]{2}$/.test(g),L=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(p)||p.trim().length===0,D=/^\(\d{2}\) \d{4}-\d{4}$/.test(v)||v.trim().length===0,$=/^\(\d{2}\) \d{5}-\d{4}$/.test(I)||I.trim().length===0,S=this.validarData(i,!0),P=this.validarData(s,!0);if(this.mostrarErro("erroLocadorParceiro",!d(o)),this.mostrarErro("erroLocadorTipoIdFiscal",!d(a)),this.mostrarErro("erroLocadorDenominacaoFuncao",!d(t)),this.mostrarErro("erroLocadorInicioRelacao",!S),this.mostrarErro("erroLocadorFimRelacao",!P),this.mostrarErro("erroLocadorNome",!d(c)),this.mostrarErro("erroLocadorCep",!f),this.mostrarErro("erroLocadorEndereco",!d(r)),this.mostrarErro("erroLocadorNumero",!y),this.mostrarErro("erroLocadorBairro",!d(m)),this.mostrarErro("erroLocadorLocal",!d(u)),this.mostrarErro("erroLocadorUf",!C),this.mostrarErro("erroLocadorEmail",!L),this.mostrarErro("erroLocadorTelefoneFixo",!D),this.mostrarErro("erroLocadorTelefoneCelular",!$),!(d(o)&&d(a)&&d(t)&&S&&P&&d(c)&&f&&d(r)&&y&&d(m)&&d(u)&&C&&L&&D&&$)){h&&(h.textContent="H√° erros nos campos.",h.style.color="#c62828",h.style.display="inline",setTimeout(()=>h.style.display="none",3e3));return}this.locadorEdits.set(e,{parceiro:o,tipoIdFiscal:a,denominacaoFuncao:t,inicioRelacao:i,fimRelacao:s,nome:c,cep:n,endereco:r,numero:l,bairro:m,local:u,uf:g,email:p,telefoneFixo:v,telefoneCelular:I}),h&&(h.textContent="Salvo com sucesso.",h.style.color="#2e7d32",h.style.display="inline",setTimeout(()=>h.style.display="none",2e3))}salvarImovel(e){const o=document.getElementById("imovelCep")?.value||"",a=document.getElementById("imovelEndereco")?.value||"",t=document.getElementById("imovelNumero")?.value||"",i=document.getElementById("imovelBairro")?.value||"",s=document.getElementById("imovelLocal")?.value||"",c=document.getElementById("imovelUf")?.value||"",n=document.getElementById("statusSalvarImovel"),r=/^\d{5}-\d{3}$/.test(o),l=a.trim().length>0,m=/^\d+$/.test(t)||t.trim().length===0,u=i.trim().length>0,g=s.trim().length>0,p=/^[A-Z]{2}$/.test(c);if(this.mostrarErro("erroImovelCep",!r),this.mostrarErro("erroImovelEndereco",!l),this.mostrarErro("erroImovelNumero",!m),this.mostrarErro("erroImovelBairro",!u),this.mostrarErro("erroImovelLocal",!g),this.mostrarErro("erroImovelUf",!p),!(r&&l&&m&&u&&g&&p)){n&&(n.textContent="H√° erros nos campos.",n.style.color="#c62828",n.style.display="inline",setTimeout(()=>n.style.display="none",3e3));return}this.imovelEdits.set(e,{cep:o,endereco:a,numero:t,bairro:i,local:s,uf:c}),n&&(n.textContent="Salvo com sucesso.",n.style.color="#2e7d32",n.style.display="inline",setTimeout(()=>n.style.display="none",2e3))}validarData(e,o=!1){if(!e)return o;const a=e.match(/^([0-3]\d)\/(0\d|1[0-2])\/(\d{4})$/);if(!a)return!1;const t=parseInt(a[1],10),i=parseInt(a[2],10),s=parseInt(a[3],10),c=new Date(s,i-1,t);return c.getFullYear()===s&&c.getMonth()===i-1&&c.getDate()===t}mostrarErro(e,o,a){const t=document.getElementById(e);t&&(t.style.display=o?"block":"none",a&&(t.textContent=a))}salvarContrato(e){const o=document.getElementById("contratoNumero")?.value||"",a=document.getElementById("contratoDenominacao")?.value||"",t=document.getElementById("contratoTipoEdificio")?.value||"",i=document.getElementById("contratoCriadoPor")?.value||"",s=document.getElementById("contratoInicio")?.value||"",c=document.getElementById("contratoFimValidade")?.value||"",n=document.getElementById("contratoRescisao")?.value||"";let r=!0;const l=y=>y.replace(/\D/g,""),m=l(o).length===8;this.mostrarErro("erroContratoNumero",!m),r=r&&m;const u=a.trim().length>0;this.mostrarErro("erroContratoDenominacao",!u),r=r&&u;const g=l(t).length===2;this.mostrarErro("erroContratoTipoEdificio",!g),r=r&&g;const p=/^[A-Z]{1}\d{6}$/.test(i.toUpperCase());this.mostrarErro("erroContratoCriadoPor",!p),r=r&&p;const v=this.validarData(s,!0);this.mostrarErro("erroContratoInicio",!v),r=r&&v;const I=this.validarData(c,!0);this.mostrarErro("erroContratoFimValidade",!I),r=r&&I;const h=c.trim().length>0,d=h?this.validarData(n,!0):n.trim().length===0;this.mostrarErro("erroContratoRescisao",!d,h?"Data inv√°lida.":"Preencha Fim da validade para habilitar."),r=r&&d;const f=document.getElementById("statusSalvarContrato");if(!r){f&&(f.textContent="H√° erros nos campos.",f.style.color="#c62828",f.style.display="inline",setTimeout(()=>f.style.display="none",3e3));return}this.contratoEdits.set(e,{numero:l(o),denominacao:a.trim(),tipoEdificio:l(t),criadoPor:i.toUpperCase(),inicio:s,fimValidade:c,rescisao:n}),f&&(f.textContent="Salvo com sucesso.",f.style.color="#2e7d32",f.style.display="inline",setTimeout(()=>f.style.display="none",2e3))}formatarStatus(e){return{ativo:"Ativo",prospeccao:"Prospec√ß√£o",mobilizacao:"Mobiliza√ß√£o",desmobilizacao:"Desmobiliza√ß√£o",disponivel:"Dispon√≠vel",ocupado:"Ocupado",manutencao:"Manuten√ß√£o",vendido:"Vendido"}[e]||e}configurarTabs(){const e=document.querySelectorAll(".tab-btn"),o=document.querySelectorAll(".tab-content");e.forEach((a,t)=>{a.addEventListener("click",()=>{e.forEach(i=>i.classList.remove("active")),o.forEach(i=>i.classList.remove("active")),a.classList.add("active"),o[t]&&o[t].classList.add("active")})})}atualizarPaginacaoImoveis(){const e=(this.currentPageImoveis-1)*this.itemsPerPageImoveis+1,o=Math.min(this.currentPageImoveis*this.itemsPerPageImoveis,this.imoveis.length),a=this.imoveis.length;this.setElementText("paginationStart",e.toString()),this.setElementText("paginationEnd",o.toString()),this.setElementText("paginationTotal",a.toString()),this.gerarBotoesPaginacao()}gerarBotoesPaginacao(){const e=document.getElementById("paginationControls");if(!e)return;e.innerHTML="";const o=Math.ceil(this.imoveis.length/this.itemsPerPageImoveis);if(o<=1)return;const a=document.createElement("button");a.innerHTML="‚Üê Anterior",a.disabled=this.currentPageImoveis===1,a.addEventListener("click",()=>{this.currentPageImoveis>1&&(this.currentPageImoveis--,this.atualizarTabelaImoveis())}),e.appendChild(a);const t=5;let i=Math.max(1,this.currentPageImoveis-Math.floor(t/2)),s=Math.min(o,i+t-1);if(s-i<t-1&&(i=Math.max(1,s-t+1)),i>1){const n=document.createElement("button");if(n.textContent="1",n.addEventListener("click",()=>{this.currentPageImoveis=1,this.atualizarTabelaImoveis()}),e.appendChild(n),i>2){const r=document.createElement("button");r.textContent="...",r.disabled=!0,e.appendChild(r)}}for(let n=i;n<=s;n++){const r=document.createElement("button");r.textContent=n.toString(),r.classList.toggle("active",n===this.currentPageImoveis);const l=n;r.addEventListener("click",()=>{this.currentPageImoveis=l,this.atualizarTabelaImoveis()}),e.appendChild(r)}if(s<o){if(s<o-1){const r=document.createElement("button");r.textContent="...",r.disabled=!0,e.appendChild(r)}const n=document.createElement("button");n.textContent=o.toString(),n.addEventListener("click",()=>{this.currentPageImoveis=o,this.atualizarTabelaImoveis()}),e.appendChild(n)}const c=document.createElement("button");c.innerHTML="Pr√≥ximo ‚Üí",c.disabled=this.currentPageImoveis===o,c.addEventListener("click",()=>{this.currentPageImoveis<o&&(this.currentPageImoveis++,this.atualizarTabelaImoveis())}),e.appendChild(c)}configurarFiltrosImoveisImediato(){this.addEventListenerSafe("pesquisarImoveis","click",()=>{this.aplicarFiltrosImoveis()}),this.addEventListenerSafe("limparFiltrosImoveis","click",()=>{this.limparFiltrosImoveis()}),this.addEventListenerSafe("filtroContrato","keypress",e=>{e.key==="Enter"&&this.aplicarFiltrosImoveis()}),this.addEventListenerSafe("filtroDenominacao","keypress",e=>{e.key==="Enter"&&this.aplicarFiltrosImoveis()})}aplicarFiltrosImoveis(){console.log("üîç Aplicando filtros de im√≥veis...");const e=document.getElementById("filtroContrato")?.value.toLowerCase()||"",o=document.getElementById("filtroUtilizacao")?.value||"",a=document.getElementById("filtroStatus")?.value||"",t=document.getElementById("filtroDenominacao")?.value.toLowerCase()||"",i=document.getElementById("filtroDataInicio")?.value||"",s=document.getElementById("filtroDataFim")?.value||"";this.imoveis=this.imoveisOriginais.filter(c=>{if(e&&!c.codigo.toLowerCase().includes(e)||o&&c.utilizacaoPrincipal!==o)return!1;if(a){const n={Ativo:"ativo","Em Prospec√ß√£o":"prospeccao","Em Mobiliza√ß√£o":"mobilizacao","Em Desmobiliza√ß√£o":"desmobilizacao",Desativado:"desativado"};if(c.status!==n[a])return!1}if(t&&!c.denominacao.toLowerCase().includes(t))return!1;if(i||s){if(c.fimValidade){const[n,r,l]=c.fimValidade.split("/"),m=new Date(parseInt(l),parseInt(r)-1,parseInt(n));if(i){const u=new Date(i);if(m<u)return!1}if(s){const u=new Date(s);if(m>u)return!1}}else if(i||s)return!1}return!0}),this.currentPageImoveis=1,this.atualizarTabelaImoveis(),this.atualizarDashboard(),console.log(`‚úÖ Filtros aplicados: ${this.imoveis.length} im√≥veis encontrados`)}limparFiltrosImoveis(){const e=document.getElementById("filtroContrato"),o=document.getElementById("filtroUtilizacao"),a=document.getElementById("filtroStatus"),t=document.getElementById("filtroDenominacao"),i=document.getElementById("filtroDataInicio"),s=document.getElementById("filtroDataFim");e&&(e.value=""),o&&(o.value=""),a&&(a.value=""),t&&(t.value=""),i&&(i.value=""),s&&(s.value=""),this.imoveis=[...this.imoveisOriginais],this.currentPageImoveis=1,this.atualizarTabelaImoveis(),this.atualizarDashboard(),console.log("üßπ Filtros limpos")}atualizarDashboard(){const e=this.calcularEstatisticas();this.setElementText("totalImoveis",e.totalImoveis.toString()),this.setElementText("imoveisAtivos",e.imoveisAtivos.toString()),this.setElementText("imoveisProspeccao",e.imoveisProspeccao.toString()),this.setElementText("imoveisMobilizacao",e.imoveisMobilizacao.toString()),this.setElementText("imoveisDesmobilizacao",e.imoveisDesmobilizacao.toString())}calcularEstatisticas(){return{totalImoveis:this.imoveis.length,imoveisAtivos:this.imoveis.filter(e=>e.status==="ativo").length,imoveisProspeccao:this.imoveis.filter(e=>e.status==="prospeccao").length,imoveisMobilizacao:this.imoveis.filter(e=>e.status==="mobilizacao").length,imoveisDesmobilizacao:this.imoveis.filter(e=>e.status==="desmobilizacao").length,totalLocadores:this.locadores.length}}}function k(){const b="https://osvaldojeronymo.github.io/silic-portal-imoveis/",e=document.referrer,o=window.location.search.includes("from=portal");(e.includes("silic-portal")||o)&&window.history.length>1?window.history.back():window.location.href=b}export{F as SistemaSILIC,k as voltarAoPortal};
